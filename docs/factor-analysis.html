<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Factor Analysis | Advanced Measurement Theory Course Notebook</title>
  <meta name="description" content="This is a Course Notebook for Advanced Measurement Theory (ERMA 8350)" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Factor Analysis | Advanced Measurement Theory Course Notebook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a Course Notebook for Advanced Measurement Theory (ERMA 8350)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Factor Analysis | Advanced Measurement Theory Course Notebook" />
  
  <meta name="twitter:description" content="This is a Course Notebook for Advanced Measurement Theory (ERMA 8350)" />
  

<meta name="author" content="William M. Murrah" />


<meta name="date" content="2021-08-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="CCT.html"/>
<link rel="next" href="path-analysis-and-structural-equation-modeling.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Measurement Theory Notebook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction to the Course</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software"><i class="fa fa-check"></i>Software</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources-for-learning-r"><i class="fa fa-check"></i>Resources for Learning R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-packages"><i class="fa fa-check"></i>R Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-these-notes"><i class="fa fa-check"></i>How To Use These Notes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="CCT.html"><a href="CCT.html"><i class="fa fa-check"></i><b>1</b> Classic Test Theory</a>
<ul>
<li class="chapter" data-level="1.1" data-path="CCT.html"><a href="CCT.html#classical-true-score-model"><i class="fa fa-check"></i><b>1.1</b> Classical True Score Model</a></li>
<li class="chapter" data-level="1.2" data-path="CCT.html"><a href="CCT.html#reliability"><i class="fa fa-check"></i><b>1.2</b> Reliability</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="CCT.html"><a href="CCT.html#cronbachs-alpha"><i class="fa fa-check"></i><b>1.2.1</b> Cronbach’s <span class="math inline">\(\alpha\)</span></a></li>
<li class="chapter" data-level="1.2.2" data-path="CCT.html"><a href="CCT.html#other-reliability-coefficients"><i class="fa fa-check"></i><b>1.2.2</b> Other Reliability Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="CCT.html"><a href="CCT.html#generalizability-theory"><i class="fa fa-check"></i><b>1.3</b> Generalizability Theory</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="CCT.html"><a href="CCT.html#reliability-and-generalizability"><i class="fa fa-check"></i><b>1.3.1</b> Reliability and Generalizability</a></li>
<li class="chapter" data-level="1.3.2" data-path="CCT.html"><a href="CCT.html#multiple-sources-of-error"><i class="fa fa-check"></i><b>1.3.2</b> Multiple Sources of Error</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="CCT.html"><a href="CCT.html#additional-readings"><i class="fa fa-check"></i><b>1.4</b> Additional Readings</a></li>
<li class="chapter" data-level="1.5" data-path="CCT.html"><a href="CCT.html#r-scripts"><i class="fa fa-check"></i><b>1.5</b> R Scripts</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="CCT.html"><a href="CCT.html#simulating-ctt-data"><i class="fa fa-check"></i><b>1.5.1</b> Simulating CTT data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>2</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="factor-analysis.html"><a href="factor-analysis.html#correlation-coefficient"><i class="fa fa-check"></i><b>2.1</b> Correlation Coefficient</a></li>
<li class="chapter" data-level="2.2" data-path="factor-analysis.html"><a href="factor-analysis.html#think-about-these-situations"><i class="fa fa-check"></i><b>2.2</b> Think about these situations</a></li>
<li class="chapter" data-level="2.3" data-path="factor-analysis.html"><a href="factor-analysis.html#solutions"><i class="fa fa-check"></i><b>2.3</b> Solutions</a></li>
<li class="chapter" data-level="2.4" data-path="factor-analysis.html"><a href="factor-analysis.html#principal-components-analysis"><i class="fa fa-check"></i><b>2.4</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="2.5" data-path="factor-analysis.html"><a href="factor-analysis.html#factor-analysis-1"><i class="fa fa-check"></i><b>2.5</b> Factor Analysis</a></li>
<li class="chapter" data-level="2.6" data-path="factor-analysis.html"><a href="factor-analysis.html#components"><i class="fa fa-check"></i><b>2.6</b> Components</a></li>
<li class="chapter" data-level="2.7" data-path="factor-analysis.html"><a href="factor-analysis.html#pc-extraction"><i class="fa fa-check"></i><b>2.7</b> PC Extraction</a></li>
<li class="chapter" data-level="2.8" data-path="factor-analysis.html"><a href="factor-analysis.html#eigenvalues"><i class="fa fa-check"></i><b>2.8</b> Eigenvalues</a></li>
<li class="chapter" data-level="2.9" data-path="factor-analysis.html"><a href="factor-analysis.html#determining-the-number-of-factors"><i class="fa fa-check"></i><b>2.9</b> Determining the Number of Factors</a></li>
<li class="chapter" data-level="2.10" data-path="factor-analysis.html"><a href="factor-analysis.html#example-data"><i class="fa fa-check"></i><b>2.10</b> Example data</a></li>
<li class="chapter" data-level="2.11" data-path="factor-analysis.html"><a href="factor-analysis.html#kaiser"><i class="fa fa-check"></i><b>2.11</b> Kaiser</a></li>
<li class="chapter" data-level="2.12" data-path="factor-analysis.html"><a href="factor-analysis.html#scree-plot"><i class="fa fa-check"></i><b>2.12</b> Scree Plot</a></li>
<li class="chapter" data-level="2.13" data-path="factor-analysis.html"><a href="factor-analysis.html#horns-parallel-analysis"><i class="fa fa-check"></i><b>2.13</b> Horn’s Parallel Analysis</a></li>
<li class="chapter" data-level="2.14" data-path="factor-analysis.html"><a href="factor-analysis.html#another-example"><i class="fa fa-check"></i><b>2.14</b> Another example</a></li>
<li class="chapter" data-level="2.15" data-path="factor-analysis.html"><a href="factor-analysis.html#rotation"><i class="fa fa-check"></i><b>2.15</b> Rotation</a></li>
<li class="chapter" data-level="2.16" data-path="factor-analysis.html"><a href="factor-analysis.html#orthogonal-rotation"><i class="fa fa-check"></i><b>2.16</b> Orthogonal Rotation</a></li>
<li class="chapter" data-level="2.17" data-path="factor-analysis.html"><a href="factor-analysis.html#oblique-rotation"><i class="fa fa-check"></i><b>2.17</b> Oblique Rotation</a></li>
<li class="chapter" data-level="2.18" data-path="factor-analysis.html"><a href="factor-analysis.html#factor-matrices"><i class="fa fa-check"></i><b>2.18</b> Factor Matrices</a></li>
<li class="chapter" data-level="2.19" data-path="factor-analysis.html"><a href="factor-analysis.html#which-matrix-should-we-interpret"><i class="fa fa-check"></i><b>2.19</b> Which matrix should we interpret?</a></li>
<li class="chapter" data-level="2.20" data-path="factor-analysis.html"><a href="factor-analysis.html#which-variables-should-be-used-to-interpret-each-factor"><i class="fa fa-check"></i><b>2.20</b> Which variables should be used to interpret each factor?</a></li>
<li class="chapter" data-level="2.21" data-path="factor-analysis.html"><a href="factor-analysis.html#examples"><i class="fa fa-check"></i><b>2.21</b> Examples</a></li>
<li class="chapter" data-level="2.22" data-path="factor-analysis.html"><a href="factor-analysis.html#steps-in-factor-analysis"><i class="fa fa-check"></i><b>2.22</b> Steps in Factor Analysis</a></li>
<li class="chapter" data-level="2.23" data-path="factor-analysis.html"><a href="factor-analysis.html#tom-swifts-electric-factor-analysis-factory"><i class="fa fa-check"></i><b>2.23</b> Tom Swift’s Electric Factor Analysis Factory</a></li>
<li class="chapter" data-level="2.24" data-path="factor-analysis.html"><a href="factor-analysis.html#metal-boxes"><i class="fa fa-check"></i><b>2.24</b> Metal Boxes</a></li>
<li class="chapter" data-level="2.25" data-path="factor-analysis.html"><a href="factor-analysis.html#correlations"><i class="fa fa-check"></i><b>2.25</b> Correlations</a></li>
<li class="chapter" data-level="2.26" data-path="factor-analysis.html"><a href="factor-analysis.html#eigenvalues-1"><i class="fa fa-check"></i><b>2.26</b> Eigenvalues &gt; 1</a></li>
<li class="chapter" data-level="2.27" data-path="factor-analysis.html"><a href="factor-analysis.html#orthogonal-rotation-1"><i class="fa fa-check"></i><b>2.27</b> Orthogonal Rotation</a></li>
<li class="chapter" data-level="2.28" data-path="factor-analysis.html"><a href="factor-analysis.html#orthogonal-rotation-with-loadings-.70"><i class="fa fa-check"></i><b>2.28</b> Orthogonal Rotation with Loadings &gt; .70</a></li>
<li class="chapter" data-level="2.29" data-path="factor-analysis.html"><a href="factor-analysis.html#r-code-for-chapter-2"><i class="fa fa-check"></i><b>2.29</b> R Code for Chapter 2</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="path-analysis-and-structural-equation-modeling.html"><a href="path-analysis-and-structural-equation-modeling.html"><i class="fa fa-check"></i><b>3</b> Path Analysis and Structural Equation Modeling</a></li>
<li class="chapter" data-level="4" data-path="item-response-theory.html"><a href="item-response-theory.html"><i class="fa fa-check"></i><b>4</b> Item Response Theory</a>
<ul>
<li class="chapter" data-level="4.1" data-path="item-response-theory.html"><a href="item-response-theory.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="item-response-theory.html"><a href="item-response-theory.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="principal-components-analysis-1.html"><a href="principal-components-analysis-1.html"><i class="fa fa-check"></i><b>5</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="6" data-path="correspondence-analysis.html"><a href="correspondence-analysis.html"><i class="fa fa-check"></i><b>6</b> Correspondence Analysis</a></li>
<li class="chapter" data-level="7" data-path="gifi-methods.html"><a href="gifi-methods.html"><i class="fa fa-check"></i><b>7</b> Gifi Methods</a></li>
<li class="chapter" data-level="8" data-path="multidimensional-scaling.html"><a href="multidimensional-scaling.html"><i class="fa fa-check"></i><b>8</b> Multidimensional Scaling</a></li>
<li class="chapter" data-level="9" data-path="graphing-multidimensional-data.html"><a href="graphing-multidimensional-data.html"><i class="fa fa-check"></i><b>9</b> Graphing Multidimensional Data</a></li>
<li class="chapter" data-level="10" data-path="networks.html"><a href="networks.html"><i class="fa fa-check"></i><b>10</b> Networks</a></li>
<li class="chapter" data-level="11" data-path="modeling-trajectories-and-time-series.html"><a href="modeling-trajectories-and-time-series.html"><i class="fa fa-check"></i><b>11</b> Modeling Trajectories and Time Series</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Measurement Theory Course Notebook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factor-analysis" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Factor Analysis</h1>
<div id="correlation-coefficient" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Correlation Coefficient</h2>
<p><em>Pearson product-moment correlation</em>:</p>
<p><span class="math display">\[
r_{xy} = \frac{\Sigma_{n=1}^n (x_k - \bar{x})(y_i - \bar{y})}{\sqrt{\Sigma_{n=1}^n(x_i - \bar{x})^2} \sqrt{\Sigma_{n=1}^n(y_i - \bar{y})^2}} = \frac{s_{xy}}{s_x s_y}.
\]</span></p>
<p>The equation looks very daunting, until you see that it is just the covariance of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> divided by the product of their standard deviations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="factor-analysis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb1-2"><a href="factor-analysis.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;YouthDep&quot;</span>)</span>
<span id="cb1-3"><a href="factor-analysis.html#cb1-3" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb1-4"><a href="factor-analysis.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb1-5"><a href="factor-analysis.html#cb1-5" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb1-6"><a href="factor-analysis.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb1-7"><a href="factor-analysis.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(item1, item2)</span></code></pre></div>
<pre><code>     item2
item1    0    1
    0 1353  656
    1  115  166</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="factor-analysis.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ------ correlation coefficients</span></span>
<span id="cb3-2"><a href="factor-analysis.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;psych&quot;</span>)</span>
<span id="cb3-3"><a href="factor-analysis.html#cb3-3" aria-hidden="true" tabindex="-1"></a>tetcor <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(<span class="fu">cbind</span>(item1, item2))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="factor-analysis.html#cb4-1" aria-hidden="true" tabindex="-1"></a>tetcor</span></code></pre></div>
<pre><code>Call: tetrachoric(x = cbind(item1, item2))
tetrachoric correlation 
      item1 item2
item1 1.00       
item2 0.35  1.00 

 with tau of 
item1 item2 
 1.16  0.36 </code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="factor-analysis.html#cb6-1" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb6-2"><a href="factor-analysis.html#cb6-2" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb6-3"><a href="factor-analysis.html#cb6-3" aria-hidden="true" tabindex="-1"></a>polcor <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(<span class="fu">cbind</span>(item1, item2))</span>
<span id="cb6-4"><a href="factor-analysis.html#cb6-4" aria-hidden="true" tabindex="-1"></a>polcor</span></code></pre></div>
<pre><code>Call: polychoric(x = cbind(item1, item2))
Polychoric correlations 
      item1 item2
item1 1.00       
item2 0.33  1.00 

 with tau of 
         1   2
item1 1.16 2.3
item2 0.36 1.2</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="factor-analysis.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.tetra</span>(<span class="at">r =</span> .<span class="dv">35</span>, <span class="at">t1 =</span> <span class="fl">1.16</span>, <span class="at">t2 =</span> .<span class="dv">36</span>)</span></code></pre></div>
<p><img src="AdvancedMeasurementTheoryNotebook_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="factor-analysis.html#cb9-1" aria-hidden="true" tabindex="-1"></a>DepItems <span class="ot">&lt;-</span> YouthDep[,<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] </span>
<span id="cb9-2"><a href="factor-analysis.html#cb9-2" aria-hidden="true" tabindex="-1"></a>Depnum <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(DepItems) <span class="sc">-</span> <span class="dv">1</span>  <span class="do">## convert to numeric   </span></span>
<span id="cb9-3"><a href="factor-analysis.html#cb9-3" aria-hidden="true" tabindex="-1"></a>Rdep <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(Depnum)</span></code></pre></div>
</div>
<div id="think-about-these-situations" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Think about these situations</h2>
<p>What do you do when you have a large number of variables you are considering as predictors of a dependent variable?</p>
<ul>
<li>Often, subsets of these variables are measuring the same, or very similar things.</li>
<li>We might like to reduce the variables to a smaller number of predictors.</li>
</ul>
<p>What if you are developing a measurement scale and have a large number of items you think measure the same construct</p>
<ul>
<li>You might want to see how strongly the items are related to the construct.</li>
</ul>
</div>
<div id="solutions" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Solutions</h2>
<ol style="list-style-type: decimal">
<li><p>Principal Components Analysis</p>
<ul>
<li>transforming the original variables into a new set of linear combinations (pricipal components).</li>
</ul></li>
<li><p>Factor Analysis</p>
<ul>
<li>setting up a mathematical model to estimate the number or factors</li>
</ul></li>
</ol>
</div>
<div id="principal-components-analysis" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Principal Components Analysis</h2>
<ul>
<li>Concerned with explaining variance-covariance structure of a set of variables.</li>
<li>PCA attempts to explain as much of the total variance among the observed variables as possible with a smaller number of components.</li>
<li>Because the variables are standardized prior to analysis, the total amount of variance available is the number of variables.</li>
<li>The goal is <strong>data reduction</strong> for subsequent analysis.</li>
<li>Variables <em>cause</em> components.</li>
<li>Components are not representative of any underlying theory.</li>
</ul>
</div>
<div id="factor-analysis-1" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Factor Analysis</h2>
<ul>
<li>The goal is understanding underlying constructs.</li>
<li>Uses a modified correlation matrix (reduced matrix)</li>
<li>factors <em>cause</em> the variables.</li>
<li>Factors represent theoretical constructs.</li>
<li>Focuses on the common variance of the variables, and purges the unique variance.</li>
</ul>
</div>
<div id="components" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Components</h2>
<p>The principal components partition the total variance (the sum of the variances of the original variables) by finding the linear combination of the variables that account for the maximum amount of variance:</p>
<p><span class="math display">\[
PC1 = a_{11}x_1 + a_{12}x_2 ... a_{1p}x_p, 
\]</span>
This is repeated as many time as there are variables.</p>
</div>
<div id="pc-extraction" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> PC Extraction</h2>
<p>draw pretty pictures on the board</p>
</div>
<div id="eigenvalues" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Eigenvalues</h2>
<p>Eigenvalues represent the variance in the variables explained by the success components.</p>
</div>
<div id="determining-the-number-of-factors" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> Determining the Number of Factors</h2>
<ol style="list-style-type: decimal">
<li>Kaiser criterion: Retain only factors with eigenvalues &gt; 1. (generally accurate)</li>
<li>Scree plot: plot eigenvalues and drop factors after leveling off.</li>
<li>Parallel analysis: compare observed eigenvalues to parallel set of data from randomly generated data. Retain factors in original if eigenvalue is greater than random eigenvalue.</li>
<li>Factor meaningfulness is also very important to consider.</li>
</ol>
</div>
<div id="example-data" class="section level2" number="2.10">
<h2><span class="header-section-number">2.10</span> Example data</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="factor-analysis.html#cb10-1" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb10-2"><a href="factor-analysis.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">1.00</span></span>
<span id="cb10-3"><a href="factor-analysis.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">0.70 1.00</span></span>
<span id="cb10-4"><a href="factor-analysis.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">0.65 0.66 1.00</span></span>
<span id="cb10-5"><a href="factor-analysis.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">0.62 0.63 0.60 1.00</span></span>
<span id="cb10-6"><a href="factor-analysis.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb10-7"><a href="factor-analysis.html#cb10-7" aria-hidden="true" tabindex="-1"></a>cormat <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;d1&quot;</span>, <span class="st">&quot;d2&quot;</span>, <span class="st">&quot;d3&quot;</span>, <span class="st">&quot;d4&quot;</span>))</span>
<span id="cb10-8"><a href="factor-analysis.html#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="factor-analysis.html#cb10-9" aria-hidden="true" tabindex="-1"></a>cormat</span></code></pre></div>
<pre><code>     d1   d2   d3   d4
d1 1.00 0.70 0.65 0.62
d2 0.70 1.00 0.66 0.63
d3 0.65 0.66 1.00 0.60
d4 0.62 0.63 0.60 1.00</code></pre>
</div>
<div id="kaiser" class="section level2" number="2.11">
<h2><span class="header-section-number">2.11</span> Kaiser</h2>
<p>Retain factors with eigenvalues greater than 1</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="factor-analysis.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cormat)<span class="sc">$</span>values</span></code></pre></div>
<pre><code>[1] 2.9311792 0.4103921 0.3592372 0.2991916</code></pre>
</div>
<div id="scree-plot" class="section level2" number="2.12">
<h2><span class="header-section-number">2.12</span> Scree Plot</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="factor-analysis.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(cormat, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="AdvancedMeasurementTheoryNotebook_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="horns-parallel-analysis" class="section level2" number="2.13">
<h2><span class="header-section-number">2.13</span> Horn’s Parallel Analysis</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="factor-analysis.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(cormat, <span class="at">fa =</span> <span class="st">&quot;pc&quot;</span>)</span></code></pre></div>
<p><img src="AdvancedMeasurementTheoryNotebook_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  NA  and the number of components =  1 </code></pre>
</div>
<div id="another-example" class="section level2" number="2.14">
<h2><span class="header-section-number">2.14</span> Another example</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="factor-analysis.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(Harman74.cor<span class="sc">$</span>cov, <span class="at">fa =</span> <span class="st">&quot;pc&quot;</span>)</span></code></pre></div>
<p><img src="AdvancedMeasurementTheoryNotebook_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  NA  and the number of components =  2 </code></pre>
</div>
<div id="rotation" class="section level2" number="2.15">
<h2><span class="header-section-number">2.15</span> Rotation</h2>
<ul>
<li>Principal components are derived to maximize the variance accounted for (data reduction).</li>
<li>Rotation is done to make the factors more interpretable (i.e. meaningful).</li>
<li>Two major classes of rotation:
<ul>
<li>Orthogonal - new factors are still uncorrelated, as were the initial factors.</li>
<li>Oblique - new factors are allowed to be correlated.</li>
</ul></li>
</ul>
<p>Essentially reallocates the loadings. The first factor may not be the one accounting for the most variance.</p>
</div>
<div id="orthogonal-rotation" class="section level2" number="2.16">
<h2><span class="header-section-number">2.16</span> Orthogonal Rotation</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Quartimax</strong> - idea is to clean up the <em>variables</em>. Rotation done so each variable loads mainly on one factor. Problematic if there is a general factor on which most or all variables load on (think IQ).</p></li>
<li><p><strong>Varimax</strong> - to clean up <em>factors</em>. So each factor has high correlation with a smaller number of variables, low correlation with the other variables. Generally makes interpretation easier.</p></li>
</ol>
</div>
<div id="oblique-rotation" class="section level2" number="2.17">
<h2><span class="header-section-number">2.17</span> Oblique Rotation</h2>
<ul>
<li>Often correlated factors are more reasonable.</li>
<li>Therefore, oblique rotation is often preferred.</li>
<li>But interpretation is more complicated.</li>
</ul>
</div>
<div id="factor-matrices" class="section level2" number="2.18">
<h2><span class="header-section-number">2.18</span> Factor Matrices</h2>
<ol style="list-style-type: decimal">
<li>Factor pattern matrix:
<ul>
<li>includes <em>pattern coefficients</em> analogous to standardized partial regression coefficients.</li>
<li>Indicated the unique importance of a factor to a variable, holding other factors constant.</li>
</ul></li>
<li>Factor structure matrix:
<ul>
<li>includes <em>structure coefficients</em> which are simple correlations of the variables with the factors.</li>
</ul></li>
</ol>
</div>
<div id="which-matrix-should-we-interpret" class="section level2" number="2.19">
<h2><span class="header-section-number">2.19</span> Which matrix should we interpret?</h2>
<ul>
<li><p>When orthogonal rotation is used interpret <em>structural coefficients</em> (but they are the same as pattern coefficients).</p></li>
<li><p>When oblique rotation is used pattern coefficients are preferred because they account for the correlation between the factors and they are parameters of the correlated factor model (which we will discuss next class).</p></li>
</ul>
</div>
<div id="which-variables-should-be-used-to-interpret-each-factor" class="section level2" number="2.20">
<h2><span class="header-section-number">2.20</span> Which variables should be used to interpret each factor?</h2>
<ul>
<li>The idea is to use only those variables that have a strong association with the factor.</li>
<li>Typical thresholds are |.30| or |.40|.</li>
<li>Content knowledge is critical.</li>
</ul>
</div>
<div id="examples" class="section level2" number="2.21">
<h2><span class="header-section-number">2.21</span> Examples</h2>
<p>Let’s look at some examples</p>
</div>
<div id="steps-in-factor-analysis" class="section level2" number="2.22">
<h2><span class="header-section-number">2.22</span> Steps in Factor Analysis</h2>
<ol style="list-style-type: decimal">
<li>Choose extraction method
<ul>
<li>So far we’ve focused on PCA</li>
</ul></li>
<li>Determine the number of components/factors
<ul>
<li>Kaiser method: eigenvalues &gt; 1</li>
<li>Scree plot: All components before leveling off</li>
<li>Horn’s parallel analysis: components/factors greater than simulated values from random numbers</li>
</ul></li>
<li>Rotate Factors
<ul>
<li>Orthogonal</li>
<li>Oblique</li>
</ul></li>
<li>Interpret Components/Factors</li>
</ol>
</div>
<div id="tom-swifts-electric-factor-analysis-factory" class="section level2" number="2.23">
<h2><span class="header-section-number">2.23</span> Tom Swift’s Electric Factor Analysis Factory</h2>
<p>“Little Jiffy” method of factor analysis</p>
<ol style="list-style-type: decimal">
<li>Extraction method : PCA</li>
<li>Number of factors: eigenvalues &gt; 1</li>
<li>Rotation: orthogonal(varimax)</li>
<li>Interpretation</li>
</ol>
</div>
<div id="metal-boxes" class="section level2" number="2.24">
<h2><span class="header-section-number">2.24</span> Metal Boxes</h2>
<table>
<caption><span id="tab:unnamed-chunk-10">Table 2.1: </span>Functional Definitions of Tom Swift’s Original 11 Variables</caption>
<thead>
<tr class="header">
<th align="left">Dimension</th>
<th align="left">Derivation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Thickness</td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">Width</td>
<td align="left">y</td>
</tr>
<tr class="odd">
<td align="left">Length</td>
<td align="left">z</td>
</tr>
<tr class="even">
<td align="left">Volume</td>
<td align="left">xyz</td>
</tr>
<tr class="odd">
<td align="left">Density</td>
<td align="left">d</td>
</tr>
<tr class="even">
<td align="left">Weight</td>
<td align="left">xyzd</td>
</tr>
<tr class="odd">
<td align="left">Surface area</td>
<td align="left">2(xy + xz + yz)</td>
</tr>
<tr class="even">
<td align="left">Cross-section</td>
<td align="left">yz</td>
</tr>
<tr class="odd">
<td align="left">Edge length</td>
<td align="left">4(x + y + z)</td>
</tr>
<tr class="even">
<td align="left">Diagonal length</td>
<td align="left">(x^2)</td>
</tr>
<tr class="odd">
<td align="left">Cost/lb</td>
<td align="left">c</td>
</tr>
</tbody>
</table>
<pre><code>&#39;data.frame&#39;:   63 obs. of  11 variables:
 $ thick   : num  1.362 2.385 3.101 0.934 0.845 ...
 $ width   : num  1.71 2.83 4.32 3.2 3.84 ...
 $ length  : num  2.93 5.01 5.99 4.15 4.09 ...
 $ volume  : num  6.02 30.2 72.01 11.78 16.1 ...
 $ density : int  10 7 16 22 11 16 11 21 6 13 ...
 $ weight  : num  60 210 1152 264 176 ...
 $ surface : num  22 62.1 108.2 38 48 ...
 $ crosssec: num  5.87 15.06 23.53 12.02 16.13 ...
 $ edge    : num  23.9 39.9 51.5 31.9 36.1 ...
 $ diagonal: num  196 1444 3721 676 1089 ...
 $ cost    : num  4.48 2.37 9.77 22.21 15.86 ...</code></pre>
</div>
<div id="correlations" class="section level2" number="2.25">
<h2><span class="header-section-number">2.25</span> Correlations</h2>
<pre><code>         thick width length volume density weight surface crosssec  edge
thick     1.00  0.49   0.24   0.84   -0.13   0.59    0.74     0.46  0.61
width     0.49  1.00   0.61   0.77   -0.15   0.55    0.87     0.92  0.88
length    0.24  0.61   1.00   0.58   -0.02   0.45    0.72     0.83  0.84
volume    0.84  0.77   0.58   1.00   -0.22   0.65    0.97     0.81  0.87
density  -0.13 -0.15  -0.02  -0.22    1.00   0.44   -0.20    -0.15 -0.15
weight    0.59  0.55   0.45   0.65    0.44   1.00    0.65     0.56  0.61
surface   0.74  0.87   0.72   0.97   -0.20   0.65    1.00     0.92  0.97
crosssec  0.46  0.92   0.83   0.81   -0.15   0.56    0.92     1.00  0.96
edge      0.61  0.88   0.84   0.87   -0.15   0.61    0.97     0.96  1.00
diagonal  0.51  0.78   0.86   0.85   -0.18   0.57    0.91     0.93  0.92
cost     -0.02  0.03  -0.02  -0.11    0.62   0.24   -0.07    -0.03 -0.04
         diagonal  cost
thick        0.51 -0.02
width        0.78  0.03
length       0.86 -0.02
volume       0.85 -0.11
density     -0.18  0.62
weight       0.57  0.24
surface      0.91 -0.07
crosssec     0.93 -0.03
edge         0.92 -0.04
diagonal     1.00 -0.12
cost        -0.12  1.00</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 2.2: </span>Correlations between dimensions</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">thick</th>
<th align="right">width</th>
<th align="right">length</th>
<th align="right">volume</th>
<th align="right">density</th>
<th align="right">weight</th>
<th align="right">surface</th>
<th align="right">crosssec</th>
<th align="right">edge</th>
<th align="right">diagonal</th>
<th align="right">cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">thick</td>
<td align="right">1.00</td>
<td align="right">0.49</td>
<td align="right">0.24</td>
<td align="right">0.84</td>
<td align="right">-0.13</td>
<td align="right">0.59</td>
<td align="right">0.74</td>
<td align="right">0.46</td>
<td align="right">0.61</td>
<td align="right">0.51</td>
<td align="right">-0.02</td>
</tr>
<tr class="even">
<td align="left">width</td>
<td align="right">0.49</td>
<td align="right">1.00</td>
<td align="right">0.61</td>
<td align="right">0.77</td>
<td align="right">-0.15</td>
<td align="right">0.55</td>
<td align="right">0.87</td>
<td align="right">0.92</td>
<td align="right">0.88</td>
<td align="right">0.78</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">length</td>
<td align="right">0.24</td>
<td align="right">0.61</td>
<td align="right">1.00</td>
<td align="right">0.58</td>
<td align="right">-0.02</td>
<td align="right">0.45</td>
<td align="right">0.72</td>
<td align="right">0.83</td>
<td align="right">0.84</td>
<td align="right">0.86</td>
<td align="right">-0.02</td>
</tr>
<tr class="even">
<td align="left">volume</td>
<td align="right">0.84</td>
<td align="right">0.77</td>
<td align="right">0.58</td>
<td align="right">1.00</td>
<td align="right">-0.22</td>
<td align="right">0.65</td>
<td align="right">0.97</td>
<td align="right">0.81</td>
<td align="right">0.87</td>
<td align="right">0.85</td>
<td align="right">-0.11</td>
</tr>
<tr class="odd">
<td align="left">density</td>
<td align="right">-0.13</td>
<td align="right">-0.15</td>
<td align="right">-0.02</td>
<td align="right">-0.22</td>
<td align="right">1.00</td>
<td align="right">0.44</td>
<td align="right">-0.20</td>
<td align="right">-0.15</td>
<td align="right">-0.15</td>
<td align="right">-0.18</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">weight</td>
<td align="right">0.59</td>
<td align="right">0.55</td>
<td align="right">0.45</td>
<td align="right">0.65</td>
<td align="right">0.44</td>
<td align="right">1.00</td>
<td align="right">0.65</td>
<td align="right">0.56</td>
<td align="right">0.61</td>
<td align="right">0.57</td>
<td align="right">0.24</td>
</tr>
<tr class="odd">
<td align="left">surface</td>
<td align="right">0.74</td>
<td align="right">0.87</td>
<td align="right">0.72</td>
<td align="right">0.97</td>
<td align="right">-0.20</td>
<td align="right">0.65</td>
<td align="right">1.00</td>
<td align="right">0.92</td>
<td align="right">0.97</td>
<td align="right">0.91</td>
<td align="right">-0.07</td>
</tr>
<tr class="even">
<td align="left">crosssec</td>
<td align="right">0.46</td>
<td align="right">0.92</td>
<td align="right">0.83</td>
<td align="right">0.81</td>
<td align="right">-0.15</td>
<td align="right">0.56</td>
<td align="right">0.92</td>
<td align="right">1.00</td>
<td align="right">0.96</td>
<td align="right">0.93</td>
<td align="right">-0.03</td>
</tr>
<tr class="odd">
<td align="left">edge</td>
<td align="right">0.61</td>
<td align="right">0.88</td>
<td align="right">0.84</td>
<td align="right">0.87</td>
<td align="right">-0.15</td>
<td align="right">0.61</td>
<td align="right">0.97</td>
<td align="right">0.96</td>
<td align="right">1.00</td>
<td align="right">0.92</td>
<td align="right">-0.04</td>
</tr>
<tr class="even">
<td align="left">diagonal</td>
<td align="right">0.51</td>
<td align="right">0.78</td>
<td align="right">0.86</td>
<td align="right">0.85</td>
<td align="right">-0.18</td>
<td align="right">0.57</td>
<td align="right">0.91</td>
<td align="right">0.93</td>
<td align="right">0.92</td>
<td align="right">1.00</td>
<td align="right">-0.12</td>
</tr>
<tr class="odd">
<td align="left">cost</td>
<td align="right">-0.02</td>
<td align="right">0.03</td>
<td align="right">-0.02</td>
<td align="right">-0.11</td>
<td align="right">0.62</td>
<td align="right">0.24</td>
<td align="right">-0.07</td>
<td align="right">-0.03</td>
<td align="right">-0.04</td>
<td align="right">-0.12</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
</div>
<div id="eigenvalues-1" class="section level2" number="2.26">
<h2><span class="header-section-number">2.26</span> Eigenvalues &gt; 1</h2>
<p><img src="AdvancedMeasurementTheoryNotebook_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="orthogonal-rotation-1" class="section level2" number="2.27">
<h2><span class="header-section-number">2.27</span> Orthogonal Rotation</h2>
<pre><code>
Loadings:
         RC1    RC3    RC2   
thick     0.212  0.947 -0.053
width     0.801  0.382 -0.011
length    0.936 -0.006  0.054
volume    0.634  0.744 -0.122
density  -0.102 -0.060  0.930
weight    0.440  0.610  0.509
surface   0.792  0.600 -0.078
crosssec  0.942  0.287 -0.031
edge      0.892  0.422 -0.031
diagonal  0.905  0.327 -0.088
cost     -0.023 -0.012  0.841

                 RC1   RC3   RC2
SS loadings    5.298 2.699 1.868
Proportion Var 0.482 0.245 0.170
Cumulative Var 0.482 0.727 0.897</code></pre>
</div>
<div id="orthogonal-rotation-with-loadings-.70" class="section level2" number="2.28">
<h2><span class="header-section-number">2.28</span> Orthogonal Rotation with Loadings &gt; .70</h2>
<pre><code>
Loadings:
         RC1    RC3    RC2   
thick            0.947       
width     0.801              
length    0.936              
volume           0.744       
density                 0.930
weight                       
surface   0.792              
crosssec  0.942              
edge      0.892              
diagonal  0.905              
cost                    0.841

                 RC1   RC3   RC2
SS loadings    5.298 2.699 1.868
Proportion Var 0.482 0.245 0.170
Cumulative Var 0.482 0.727 0.897</code></pre>
</div>
<div id="r-code-for-chapter-2" class="section level2" number="2.29">
<h2><span class="header-section-number">2.29</span> R Code for Chapter 2</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="factor-analysis.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------- Chapter 2: Factor Analysis ------------------</span></span>
<span id="cb23-2"><a href="factor-analysis.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb23-3"><a href="factor-analysis.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;YouthDep&quot;</span>)</span>
<span id="cb23-4"><a href="factor-analysis.html#cb23-4" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb23-5"><a href="factor-analysis.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb23-6"><a href="factor-analysis.html#cb23-6" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb23-7"><a href="factor-analysis.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb23-8"><a href="factor-analysis.html#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(item1, item2)</span>
<span id="cb23-9"><a href="factor-analysis.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="factor-analysis.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ------ correlation coefficients</span></span>
<span id="cb23-11"><a href="factor-analysis.html#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;psych&quot;</span>)</span>
<span id="cb23-12"><a href="factor-analysis.html#cb23-12" aria-hidden="true" tabindex="-1"></a>tetcor <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(<span class="fu">cbind</span>(item1, item2))</span>
<span id="cb23-13"><a href="factor-analysis.html#cb23-13" aria-hidden="true" tabindex="-1"></a>tetcor</span>
<span id="cb23-14"><a href="factor-analysis.html#cb23-14" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb23-15"><a href="factor-analysis.html#cb23-15" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb23-16"><a href="factor-analysis.html#cb23-16" aria-hidden="true" tabindex="-1"></a>polcor <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(<span class="fu">cbind</span>(item1, item2))</span>
<span id="cb23-17"><a href="factor-analysis.html#cb23-17" aria-hidden="true" tabindex="-1"></a>polcor</span>
<span id="cb23-18"><a href="factor-analysis.html#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="factor-analysis.html#cb23-19" aria-hidden="true" tabindex="-1"></a>DepItems <span class="ot">&lt;-</span> YouthDep[,<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] </span>
<span id="cb23-20"><a href="factor-analysis.html#cb23-20" aria-hidden="true" tabindex="-1"></a>Depnum <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(DepItems) <span class="sc">-</span> <span class="dv">1</span>  <span class="do">## convert to numeric   </span></span>
<span id="cb23-21"><a href="factor-analysis.html#cb23-21" aria-hidden="true" tabindex="-1"></a>Rdep <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(Depnum)</span>
<span id="cb23-22"><a href="factor-analysis.html#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="factor-analysis.html#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Rmotivation&quot;</span>)</span>
<span id="cb23-24"><a href="factor-analysis.html#cb23-24" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;ext|int&quot;</span>, <span class="fu">colnames</span>(Rmotivation)) </span>
<span id="cb23-25"><a href="factor-analysis.html#cb23-25" aria-hidden="true" tabindex="-1"></a>Rmotivation1 <span class="ot">&lt;-</span> Rmotivation[, vind]</span>
<span id="cb23-26"><a href="factor-analysis.html#cb23-26" aria-hidden="true" tabindex="-1"></a>Rmot1 <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(Rmotivation1, <span class="at">smooth =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-27"><a href="factor-analysis.html#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">round</span>(<span class="fu">eigen</span>(Rmot1<span class="sc">$</span>rho)<span class="sc">$</span>values, <span class="dv">3</span>))</span>
<span id="cb23-28"><a href="factor-analysis.html#cb23-28" aria-hidden="true" tabindex="-1"></a>Rmot <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(Rmotivation1)</span>
<span id="cb23-29"><a href="factor-analysis.html#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">round</span>(<span class="fu">eigen</span>(Rmot<span class="sc">$</span>rho)<span class="sc">$</span>values, <span class="dv">3</span>))</span>
<span id="cb23-30"><a href="factor-analysis.html#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="factor-analysis.html#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- exploratory factor analysis </span></span>
<span id="cb23-32"><a href="factor-analysis.html#cb23-32" aria-hidden="true" tabindex="-1"></a>motFA <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmot<span class="sc">$</span>rho, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb23-33"><a href="factor-analysis.html#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(motFA<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.2</span>)</span>
<span id="cb23-34"><a href="factor-analysis.html#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(motFA<span class="sc">$</span>communality, <span class="dv">2</span>)</span>
<span id="cb23-35"><a href="factor-analysis.html#cb23-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-36"><a href="factor-analysis.html#cb23-36" aria-hidden="true" tabindex="-1"></a>motFA2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmot<span class="sc">$</span>rho, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;varimax&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb23-37"><a href="factor-analysis.html#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(motFA<span class="sc">$</span>loadings, <span class="at">asp =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.9</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Factor 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Factor 2&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Loadings Plot&quot;</span>)</span>
<span id="cb23-38"><a href="factor-analysis.html#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(motFA<span class="sc">$</span>loadings, <span class="at">labels =</span> <span class="fu">rownames</span>(motFA<span class="sc">$</span>loadings), <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb23-39"><a href="factor-analysis.html#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb23-40"><a href="factor-analysis.html#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(motFA2<span class="sc">$</span>loadings, <span class="at">labels =</span> <span class="fu">rownames</span>(motFA2<span class="sc">$</span>loadings), <span class="at">col =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb23-41"><a href="factor-analysis.html#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;rotated&quot;</span>, <span class="st">&quot;unrotated&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>), <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb23-42"><a href="factor-analysis.html#cb23-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-43"><a href="factor-analysis.html#cb23-43" aria-hidden="true" tabindex="-1"></a>Rmot2 <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(Rmotivation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>])</span>
<span id="cb23-44"><a href="factor-analysis.html#cb23-44" aria-hidden="true" tabindex="-1"></a>motFA3 <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmot2<span class="sc">$</span>rho, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">&quot;oblimin&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb23-45"><a href="factor-analysis.html#cb23-45" aria-hidden="true" tabindex="-1"></a>motFA3<span class="sc">$</span>loadings</span>
<span id="cb23-46"><a href="factor-analysis.html#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(motFA3<span class="sc">$</span>Phi, <span class="dv">3</span>)</span>
<span id="cb23-47"><a href="factor-analysis.html#cb23-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-48"><a href="factor-analysis.html#cb23-48" aria-hidden="true" tabindex="-1"></a>motFA2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmotivation1, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;varimax&quot;</span>, <span class="at">cor =</span> <span class="st">&quot;tet&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">scores =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb23-49"><a href="factor-analysis.html#cb23-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">missing =</span> <span class="cn">TRUE</span>, <span class="at">impute =</span> <span class="st">&quot;median&quot;</span>)</span>
<span id="cb23-50"><a href="factor-analysis.html#cb23-50" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(motFA2<span class="sc">$</span>scores)</span>
<span id="cb23-51"><a href="factor-analysis.html#cb23-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-52"><a href="factor-analysis.html#cb23-52" aria-hidden="true" tabindex="-1"></a>Rdep <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(Depnum)<span class="sc">$</span>rho</span>
<span id="cb23-53"><a href="factor-analysis.html#cb23-53" aria-hidden="true" tabindex="-1"></a>evals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Rdep)<span class="sc">$</span>values</span>
<span id="cb23-54"><a href="factor-analysis.html#cb23-54" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(Rdep, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-55"><a href="factor-analysis.html#cb23-55" aria-hidden="true" tabindex="-1"></a>(evals<span class="sc">/</span><span class="fu">sum</span>(evals)<span class="sc">*</span><span class="dv">100</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb23-56"><a href="factor-analysis.html#cb23-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-57"><a href="factor-analysis.html#cb23-57" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-58"><a href="factor-analysis.html#cb23-58" aria-hidden="true" tabindex="-1"></a>resPA <span class="ot">&lt;-</span> <span class="fu">fa.parallel</span>(Depnum, <span class="at">fa =</span> <span class="st">&quot;pc&quot;</span>, <span class="at">cor =</span> <span class="st">&quot;poly&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)  </span>
<span id="cb23-59"><a href="factor-analysis.html#cb23-59" aria-hidden="true" tabindex="-1"></a>resvss <span class="ot">&lt;-</span> <span class="fu">vss</span>(Rdep, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">n.obs =</span> <span class="fu">nrow</span>(Depnum), <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-60"><a href="factor-analysis.html#cb23-60" aria-hidden="true" tabindex="-1"></a>resvss</span>
<span id="cb23-61"><a href="factor-analysis.html#cb23-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-62"><a href="factor-analysis.html#cb23-62" aria-hidden="true" tabindex="-1"></a>fadep <span class="ot">&lt;-</span> <span class="fu">fa</span>(Depnum, <span class="dv">1</span>, <span class="at">cor =</span> <span class="st">&quot;poly&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb23-63"><a href="factor-analysis.html#cb23-63" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fadep)</span>
<span id="cb23-64"><a href="factor-analysis.html#cb23-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-65"><a href="factor-analysis.html#cb23-65" aria-hidden="true" tabindex="-1"></a>resnf <span class="ot">&lt;-</span> <span class="fu">nfactors</span>(Depnum, <span class="at">n =</span> <span class="dv">8</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">cor =</span> <span class="st">&quot;poly&quot;</span>)</span>
<span id="cb23-66"><a href="factor-analysis.html#cb23-66" aria-hidden="true" tabindex="-1"></a>resnf</span>
<span id="cb23-67"><a href="factor-analysis.html#cb23-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-68"><a href="factor-analysis.html#cb23-68" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- Bayesian exploratory factor analysis</span></span>
<span id="cb23-69"><a href="factor-analysis.html#cb23-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb23-70"><a href="factor-analysis.html#cb23-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;corrplot&quot;</span>)</span>
<span id="cb23-71"><a href="factor-analysis.html#cb23-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;BayesFM&quot;</span>)</span>
<span id="cb23-72"><a href="factor-analysis.html#cb23-72" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Privacy&quot;</span>)</span>
<span id="cb23-73"><a href="factor-analysis.html#cb23-73" aria-hidden="true" tabindex="-1"></a>Privstd <span class="ot">&lt;-</span> <span class="fu">scale</span>(Privacy)</span>
<span id="cb23-74"><a href="factor-analysis.html#cb23-74" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(Privstd))</span>
<span id="cb23-75"><a href="factor-analysis.html#cb23-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-76"><a href="factor-analysis.html#cb23-76" aria-hidden="true" tabindex="-1"></a>Nid <span class="ot">&lt;-</span> <span class="dv">2</span>              <span class="do">## minimum number of variables per factor</span></span>
<span id="cb23-77"><a href="factor-analysis.html#cb23-77" aria-hidden="true" tabindex="-1"></a>pmax <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="fu">ncol</span>(Privstd)<span class="sc">/</span>Nid)   <span class="do">## maximum number of factors</span></span>
<span id="cb23-78"><a href="factor-analysis.html#cb23-78" aria-hidden="true" tabindex="-1"></a>pmax</span>
<span id="cb23-79"><a href="factor-analysis.html#cb23-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-80"><a href="factor-analysis.html#cb23-80" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-81"><a href="factor-analysis.html#cb23-81" aria-hidden="true" tabindex="-1"></a>Rsim <span class="ot">&lt;-</span> <span class="fu">simul.R.prior</span>(pmax, <span class="at">nu0 =</span> pmax <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>))</span>
<span id="cb23-82"><a href="factor-analysis.html#cb23-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Rsim)</span>
<span id="cb23-83"><a href="factor-analysis.html#cb23-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-84"><a href="factor-analysis.html#cb23-84" aria-hidden="true" tabindex="-1"></a>Ksim <span class="ot">&lt;-</span> <span class="fu">simul.nfac.prior</span>(<span class="at">nvar =</span> <span class="fu">ncol</span>(Privstd), <span class="at">Nid =</span> Nid, <span class="at">Kmax =</span> pmax, <span class="at">kappa =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb23-85"><a href="factor-analysis.html#cb23-85" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Ksim)</span>
<span id="cb23-86"><a href="factor-analysis.html#cb23-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-87"><a href="factor-analysis.html#cb23-87" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb23-88"><a href="factor-analysis.html#cb23-88" aria-hidden="true" tabindex="-1"></a>fitbefa <span class="ot">&lt;-</span> <span class="fu">befa</span>(Privstd, <span class="at">Nid =</span> <span class="dv">2</span>, <span class="at">Kmax =</span> pmax, <span class="at">nu0 =</span> <span class="dv">10</span>, <span class="at">kappa =</span> <span class="fl">0.2</span>, <span class="at">kappa0 =</span> <span class="fl">0.1</span>, <span class="at">xi0 =</span> <span class="fl">0.1</span>,</span>
<span id="cb23-89"><a href="factor-analysis.html#cb23-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">burnin =</span> <span class="dv">5000</span>, <span class="at">iter =</span> <span class="dv">50000</span>)</span>
<span id="cb23-90"><a href="factor-analysis.html#cb23-90" aria-hidden="true" tabindex="-1"></a>fitbefa <span class="ot">&lt;-</span> <span class="fu">post.column.switch</span>(fitbefa)   <span class="do">## column reordering</span></span>
<span id="cb23-91"><a href="factor-analysis.html#cb23-91" aria-hidden="true" tabindex="-1"></a>fitbefa <span class="ot">&lt;-</span> <span class="fu">post.sign.switch</span>(fitbefa)     <span class="do">## sign switching</span></span>
<span id="cb23-92"><a href="factor-analysis.html#cb23-92" aria-hidden="true" tabindex="-1"></a>sumbefa <span class="ot">&lt;-</span> <span class="fu">summary</span>(fitbefa)</span>
<span id="cb23-93"><a href="factor-analysis.html#cb23-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-94"><a href="factor-analysis.html#cb23-94" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- confirmatory factor analysis</span></span>
<span id="cb23-95"><a href="factor-analysis.html#cb23-95" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb23-96"><a href="factor-analysis.html#cb23-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lavaan&quot;</span>)</span>
<span id="cb23-97"><a href="factor-analysis.html#cb23-97" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Rmotivation&quot;</span>)</span>
<span id="cb23-98"><a href="factor-analysis.html#cb23-98" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;ext|int&quot;</span>, <span class="fu">colnames</span>(Rmotivation)) <span class="do">## ext/int items</span></span>
<span id="cb23-99"><a href="factor-analysis.html#cb23-99" aria-hidden="true" tabindex="-1"></a>Rmot <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Rmotivation[, vind])</span>
<span id="cb23-100"><a href="factor-analysis.html#cb23-100" aria-hidden="true" tabindex="-1"></a>mot_model <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb23-101"><a href="factor-analysis.html#cb23-101" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 + ext5 + ext6 + </span></span>
<span id="cb23-102"><a href="factor-analysis.html#cb23-102" aria-hidden="true" tabindex="-1"></a><span class="st">                ext7 + ext8 + ext9 + ext10 + ext11 + ext12      </span></span>
<span id="cb23-103"><a href="factor-analysis.html#cb23-103" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 + int5&#39;</span></span>
<span id="cb23-104"><a href="factor-analysis.html#cb23-104" aria-hidden="true" tabindex="-1"></a>fitMot <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model, <span class="at">data =</span> Rmot, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot))</span>
<span id="cb23-105"><a href="factor-analysis.html#cb23-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-106"><a href="factor-analysis.html#cb23-106" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;semPlot&quot;</span>)</span>
<span id="cb23-107"><a href="factor-analysis.html#cb23-107" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="fl">4.5</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb23-108"><a href="factor-analysis.html#cb23-108" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">nCharNodes =</span> <span class="dv">4</span>)</span>
<span id="cb23-109"><a href="factor-analysis.html#cb23-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-110"><a href="factor-analysis.html#cb23-110" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>theta</span>
<span id="cb23-111"><a href="factor-analysis.html#cb23-111" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>lambda</span>
<span id="cb23-112"><a href="factor-analysis.html#cb23-112" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>)<span class="sc">$</span>lambda</span>
<span id="cb23-113"><a href="factor-analysis.html#cb23-113" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>psi</span>
<span id="cb23-114"><a href="factor-analysis.html#cb23-114" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>)<span class="sc">$</span>psi</span>
<span id="cb23-115"><a href="factor-analysis.html#cb23-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-116"><a href="factor-analysis.html#cb23-116" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitMot, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-117"><a href="factor-analysis.html#cb23-117" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitMot, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-118"><a href="factor-analysis.html#cb23-118" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitMot)[<span class="dv">5</span>,]</span>
<span id="cb23-119"><a href="factor-analysis.html#cb23-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-120"><a href="factor-analysis.html#cb23-120" aria-hidden="true" tabindex="-1"></a>mot_model2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb23-121"><a href="factor-analysis.html#cb23-121" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 + ext6 + ext7 + </span></span>
<span id="cb23-122"><a href="factor-analysis.html#cb23-122" aria-hidden="true" tabindex="-1"></a><span class="st">                ext8 + ext9 + ext10 + ext11 + ext12</span></span>
<span id="cb23-123"><a href="factor-analysis.html#cb23-123" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 + int5&#39;</span></span>
<span id="cb23-124"><a href="factor-analysis.html#cb23-124" aria-hidden="true" tabindex="-1"></a>fitMot2 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model2, <span class="at">data =</span> Rmot, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot)[<span class="sc">-</span><span class="dv">5</span>])</span>
<span id="cb23-125"><a href="factor-analysis.html#cb23-125" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">35</span>)</span>
<span id="cb23-126"><a href="factor-analysis.html#cb23-126" aria-hidden="true" tabindex="-1"></a>Rmot2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Rmotivation[, vind])</span>
<span id="cb23-127"><a href="factor-analysis.html#cb23-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-128"><a href="factor-analysis.html#cb23-128" aria-hidden="true" tabindex="-1"></a>mot_model3 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb23-129"><a href="factor-analysis.html#cb23-129" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 </span></span>
<span id="cb23-130"><a href="factor-analysis.html#cb23-130" aria-hidden="true" tabindex="-1"></a><span class="st">  hybrid =~ hyb1 + hyb2 + hyb3 + hyb4              </span></span>
<span id="cb23-131"><a href="factor-analysis.html#cb23-131" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 </span></span>
<span id="cb23-132"><a href="factor-analysis.html#cb23-132" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ extrinsic + hybrid + intrinsic&#39;</span></span>
<span id="cb23-133"><a href="factor-analysis.html#cb23-133" aria-hidden="true" tabindex="-1"></a>fitMot3 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model3, <span class="at">data =</span> Rmot2, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot2))</span>
<span id="cb23-134"><a href="factor-analysis.html#cb23-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-135"><a href="factor-analysis.html#cb23-135" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitMot3, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="dv">5</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb23-136"><a href="factor-analysis.html#cb23-136" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">nCharNodes =</span> <span class="dv">4</span>)</span>
<span id="cb23-137"><a href="factor-analysis.html#cb23-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-138"><a href="factor-analysis.html#cb23-138" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitMot3, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-139"><a href="factor-analysis.html#cb23-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-140"><a href="factor-analysis.html#cb23-140" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">35</span>, <span class="dv">39</span><span class="sc">:</span><span class="dv">41</span>)</span>
<span id="cb23-141"><a href="factor-analysis.html#cb23-141" aria-hidden="true" tabindex="-1"></a>Rmot3 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Rmotivation[, vind])</span>
<span id="cb23-142"><a href="factor-analysis.html#cb23-142" aria-hidden="true" tabindex="-1"></a>mot_model4 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb23-143"><a href="factor-analysis.html#cb23-143" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 </span></span>
<span id="cb23-144"><a href="factor-analysis.html#cb23-144" aria-hidden="true" tabindex="-1"></a><span class="st">  hybrid =~ hyb1 + hyb2 + hyb3 + hyb4              </span></span>
<span id="cb23-145"><a href="factor-analysis.html#cb23-145" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 </span></span>
<span id="cb23-146"><a href="factor-analysis.html#cb23-146" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ extrinsic + hybrid + intrinsic</span></span>
<span id="cb23-147"><a href="factor-analysis.html#cb23-147" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation ~ npkgs + phd&#39;</span></span>
<span id="cb23-148"><a href="factor-analysis.html#cb23-148" aria-hidden="true" tabindex="-1"></a>fitMot4 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model4, <span class="at">data =</span> Rmot3, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot3[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]))</span>
<span id="cb23-149"><a href="factor-analysis.html#cb23-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-150"><a href="factor-analysis.html#cb23-150" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitMot4, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="dv">5</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb23-151"><a href="factor-analysis.html#cb23-151" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">nCharNodes =</span> <span class="dv">4</span>)</span>
<span id="cb23-152"><a href="factor-analysis.html#cb23-152" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitMot4)[<span class="dv">16</span><span class="sc">:</span><span class="dv">17</span>,]</span>
<span id="cb23-153"><a href="factor-analysis.html#cb23-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-154"><a href="factor-analysis.html#cb23-154" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;semTools&quot;</span>)</span>
<span id="cb23-155"><a href="factor-analysis.html#cb23-155" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Bergh&quot;</span>)</span>
<span id="cb23-156"><a href="factor-analysis.html#cb23-156" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ EP + HP + DP + SP&#39;</span></span>
<span id="cb23-157"><a href="factor-analysis.html#cb23-157" aria-hidden="true" tabindex="-1"></a>minvfit1 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-158"><a href="factor-analysis.html#cb23-158" aria-hidden="true" tabindex="-1"></a>minvfit2 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, </span>
<span id="cb23-159"><a href="factor-analysis.html#cb23-159" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>), <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-160"><a href="factor-analysis.html#cb23-160" aria-hidden="true" tabindex="-1"></a>minvfit3 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, </span>
<span id="cb23-161"><a href="factor-analysis.html#cb23-161" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>), <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-162"><a href="factor-analysis.html#cb23-162" aria-hidden="true" tabindex="-1"></a>minvfit4 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, </span>
<span id="cb23-163"><a href="factor-analysis.html#cb23-163" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>, <span class="st">&quot;means&quot;</span>), <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-164"><a href="factor-analysis.html#cb23-164" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(minvfit1, minvfit2, minvfit3, minvfit4)</span>
<span id="cb23-165"><a href="factor-analysis.html#cb23-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-166"><a href="factor-analysis.html#cb23-166" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ c(v1,v1)*EP + c(v2,v2)*HP + c(v3,v3)*DP + SP&#39;</span></span>
<span id="cb23-167"><a href="factor-analysis.html#cb23-167" aria-hidden="true" tabindex="-1"></a>fitBase <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-168"><a href="factor-analysis.html#cb23-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-169"><a href="factor-analysis.html#cb23-169" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ EP + HP + DP + SP&#39;</span></span>
<span id="cb23-170"><a href="factor-analysis.html#cb23-170" aria-hidden="true" tabindex="-1"></a>fitBase <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>),</span>
<span id="cb23-171"><a href="factor-analysis.html#cb23-171" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;GP=~ SP&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-172"><a href="factor-analysis.html#cb23-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-173"><a href="factor-analysis.html#cb23-173" aria-hidden="true" tabindex="-1"></a>fitBase1 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>), </span>
<span id="cb23-174"><a href="factor-analysis.html#cb23-174" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;GP=~SP&quot;</span>, <span class="st">&quot;DP~1&quot;</span>, <span class="st">&quot;HP~1&quot;</span>, <span class="st">&quot;SP~1&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-175"><a href="factor-analysis.html#cb23-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-176"><a href="factor-analysis.html#cb23-176" aria-hidden="true" tabindex="-1"></a>GP_model2 <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ c(v1,v1)*EP + c(v2,v2)*HP + c(v3,v3)*DP + c(NA, 0)*SP&#39;</span></span>
<span id="cb23-177"><a href="factor-analysis.html#cb23-177" aria-hidden="true" tabindex="-1"></a>fitIO <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model2, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;intercepts&quot;</span>), </span>
<span id="cb23-178"><a href="factor-analysis.html#cb23-178" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;DP~1&quot;</span>, <span class="st">&quot;HP~1&quot;</span>, <span class="st">&quot;SP~1&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-179"><a href="factor-analysis.html#cb23-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-180"><a href="factor-analysis.html#cb23-180" aria-hidden="true" tabindex="-1"></a>fitMarg <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>),</span>
<span id="cb23-181"><a href="factor-analysis.html#cb23-181" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;DP~1&quot;</span>, <span class="st">&quot;HP~1&quot;</span>, <span class="st">&quot;SP~1&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-182"><a href="factor-analysis.html#cb23-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-183"><a href="factor-analysis.html#cb23-183" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fitMarg, fitBase1)</span>
<span id="cb23-184"><a href="factor-analysis.html#cb23-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-185"><a href="factor-analysis.html#cb23-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb23-186"><a href="factor-analysis.html#cb23-186" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lavaan&quot;</span>)</span>
<span id="cb23-187"><a href="factor-analysis.html#cb23-187" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;SDOwave&quot;</span>)</span>
<span id="cb23-188"><a href="factor-analysis.html#cb23-188" aria-hidden="true" tabindex="-1"></a>model_sdo1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb23-189"><a href="factor-analysis.html#cb23-189" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 =~ 1*I1.1996 + a2*I2.1996 + a3*I3.1996 + a4*I4.1996</span></span>
<span id="cb23-190"><a href="factor-analysis.html#cb23-190" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 =~ 1*I1.1998 + a2*I2.1998 + a3*I3.1998 + a4*I4.1998</span></span>
<span id="cb23-191"><a href="factor-analysis.html#cb23-191" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 ~~ SDO1998</span></span>
<span id="cb23-192"><a href="factor-analysis.html#cb23-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-193"><a href="factor-analysis.html#cb23-193" aria-hidden="true" tabindex="-1"></a><span class="st">  ## intercepts</span></span>
<span id="cb23-194"><a href="factor-analysis.html#cb23-194" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1996 ~ int1*1; I1.1998 ~ int1*1</span></span>
<span id="cb23-195"><a href="factor-analysis.html#cb23-195" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1996 ~ int2*1; I2.1998 ~ int2*1 </span></span>
<span id="cb23-196"><a href="factor-analysis.html#cb23-196" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1996 ~ int3*1; I3.1998 ~ int3*1</span></span>
<span id="cb23-197"><a href="factor-analysis.html#cb23-197" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1996 ~ int4*1; I4.1998 ~ int4*1</span></span>
<span id="cb23-198"><a href="factor-analysis.html#cb23-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-199"><a href="factor-analysis.html#cb23-199" aria-hidden="true" tabindex="-1"></a><span class="st">  ## residual covariances</span></span>
<span id="cb23-200"><a href="factor-analysis.html#cb23-200" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1996 ~~ I1.1998</span></span>
<span id="cb23-201"><a href="factor-analysis.html#cb23-201" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1996 ~~ I2.1998</span></span>
<span id="cb23-202"><a href="factor-analysis.html#cb23-202" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1996 ~~ I3.1998</span></span>
<span id="cb23-203"><a href="factor-analysis.html#cb23-203" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1996 ~~ I4.1998</span></span>
<span id="cb23-204"><a href="factor-analysis.html#cb23-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-205"><a href="factor-analysis.html#cb23-205" aria-hidden="true" tabindex="-1"></a><span class="st">  ## latent means: 1996 as baseline</span></span>
<span id="cb23-206"><a href="factor-analysis.html#cb23-206" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 ~ 0*1</span></span>
<span id="cb23-207"><a href="factor-analysis.html#cb23-207" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 ~ 1&#39;</span></span>
<span id="cb23-208"><a href="factor-analysis.html#cb23-208" aria-hidden="true" tabindex="-1"></a>fitsdo1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_sdo1, <span class="at">data =</span> SDOwave, <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-209"><a href="factor-analysis.html#cb23-209" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitsdo1)[<span class="dv">22</span><span class="sc">:</span><span class="dv">23</span>,]</span>
<span id="cb23-210"><a href="factor-analysis.html#cb23-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-211"><a href="factor-analysis.html#cb23-211" aria-hidden="true" tabindex="-1"></a>model_sdo2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb23-212"><a href="factor-analysis.html#cb23-212" aria-hidden="true" tabindex="-1"></a><span class="st">  ## 1st CFA level, constant loadings across time</span></span>
<span id="cb23-213"><a href="factor-analysis.html#cb23-213" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOD1996 =~ 1*I1.1996 + d1*I2.1996</span></span>
<span id="cb23-214"><a href="factor-analysis.html#cb23-214" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOD1998 =~ 1*I1.1998 + d1*I2.1998</span></span>
<span id="cb23-215"><a href="factor-analysis.html#cb23-215" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOD1999 =~ 1*I1.1999 + d1*I2.1999 </span></span>
<span id="cb23-216"><a href="factor-analysis.html#cb23-216" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOE1996 =~ 1*I3.1996 + a1*I4.1996 </span></span>
<span id="cb23-217"><a href="factor-analysis.html#cb23-217" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOE1998 =~ 1*I3.1998 + a1*I4.1998</span></span>
<span id="cb23-218"><a href="factor-analysis.html#cb23-218" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOE1999 =~ 1*I3.1999 + a1*I4.1999</span></span>
<span id="cb23-219"><a href="factor-analysis.html#cb23-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-220"><a href="factor-analysis.html#cb23-220" aria-hidden="true" tabindex="-1"></a><span class="st">  ## 2nd CFA level, constant loadings across time</span></span>
<span id="cb23-221"><a href="factor-analysis.html#cb23-221" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 =~ 1*SDOD1996 + sd1*SDOE1996</span></span>
<span id="cb23-222"><a href="factor-analysis.html#cb23-222" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 =~ 1*SDOD1998 + sd1*SDOE1998</span></span>
<span id="cb23-223"><a href="factor-analysis.html#cb23-223" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1999 =~ 1*SDOD1999 + sd1*SDOE1999</span></span>
<span id="cb23-224"><a href="factor-analysis.html#cb23-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-225"><a href="factor-analysis.html#cb23-225" aria-hidden="true" tabindex="-1"></a><span class="st">  ## Constant 1st level intercepts</span></span>
<span id="cb23-226"><a href="factor-analysis.html#cb23-226" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1996 ~ iI1*1; I1.1998 ~ iI1*1; I1.1999 ~ iI1*1</span></span>
<span id="cb23-227"><a href="factor-analysis.html#cb23-227" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1996 ~ iI2*1; I2.1998 ~ iI2*1; I2.1999 ~ iI2*1</span></span>
<span id="cb23-228"><a href="factor-analysis.html#cb23-228" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1996 ~ iI3*1; I3.1998 ~ iI3*1; I3.1999 ~ iI3*1</span></span>
<span id="cb23-229"><a href="factor-analysis.html#cb23-229" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1996 ~ iI4*1; I4.1998 ~ iI4*1; I4.1999 ~ iI4*1</span></span>
<span id="cb23-230"><a href="factor-analysis.html#cb23-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-231"><a href="factor-analysis.html#cb23-231" aria-hidden="true" tabindex="-1"></a><span class="st">  ## residual covariances:</span></span>
<span id="cb23-232"><a href="factor-analysis.html#cb23-232" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1999 ~~ I1.1998; I1.1996 ~~ I1.1998; I1.1999 ~~ I1.1996</span></span>
<span id="cb23-233"><a href="factor-analysis.html#cb23-233" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1999 ~~ I2.1998; I2.1996 ~~ I2.1998; I2.1999 ~~ I2.1996</span></span>
<span id="cb23-234"><a href="factor-analysis.html#cb23-234" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1999 ~~ I3.1998; I3.1996 ~~ I3.1998; I3.1999 ~~ I3.1996</span></span>
<span id="cb23-235"><a href="factor-analysis.html#cb23-235" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1999 ~~ I4.1998; I4.1996 ~~ I4.1998; I4.1999 ~~ I4.1996</span></span>
<span id="cb23-236"><a href="factor-analysis.html#cb23-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-237"><a href="factor-analysis.html#cb23-237" aria-hidden="true" tabindex="-1"></a><span class="st">  ## latent means</span></span>
<span id="cb23-238"><a href="factor-analysis.html#cb23-238" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 ~ 0*1    ## 1996 baseline year</span></span>
<span id="cb23-239"><a href="factor-analysis.html#cb23-239" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 ~ 1      ## 1998 vs. 1996</span></span>
<span id="cb23-240"><a href="factor-analysis.html#cb23-240" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1999 ~ 1      ## 1999 vs. 1996</span></span>
<span id="cb23-241"><a href="factor-analysis.html#cb23-241" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb23-242"><a href="factor-analysis.html#cb23-242" aria-hidden="true" tabindex="-1"></a>fitsdo2 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_sdo2, <span class="at">data =</span> SDOwave, <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb23-243"><a href="factor-analysis.html#cb23-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-244"><a href="factor-analysis.html#cb23-244" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitsdo2, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="dv">6</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb23-245"><a href="factor-analysis.html#cb23-245" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-246"><a href="factor-analysis.html#cb23-246" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitsdo2)[<span class="dv">43</span><span class="sc">:</span><span class="dv">45</span>,]</span>
<span id="cb23-247"><a href="factor-analysis.html#cb23-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-248"><a href="factor-analysis.html#cb23-248" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;FamilyIQ&quot;</span>)</span>
<span id="cb23-249"><a href="factor-analysis.html#cb23-249" aria-hidden="true" tabindex="-1"></a>modelIQ <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb23-250"><a href="factor-analysis.html#cb23-250" aria-hidden="true" tabindex="-1"></a><span class="st"> level: 1</span></span>
<span id="cb23-251"><a href="factor-analysis.html#cb23-251" aria-hidden="true" tabindex="-1"></a><span class="st">  numeric =~ wordlist + cards + matrices</span></span>
<span id="cb23-252"><a href="factor-analysis.html#cb23-252" aria-hidden="true" tabindex="-1"></a><span class="st">  perception =~ figures + animals + occupation</span></span>
<span id="cb23-253"><a href="factor-analysis.html#cb23-253" aria-hidden="true" tabindex="-1"></a><span class="st"> level: 2</span></span>
<span id="cb23-254"><a href="factor-analysis.html#cb23-254" aria-hidden="true" tabindex="-1"></a><span class="st">  general =~ wordlist + cards +  matrices + figures + animals +</span></span>
<span id="cb23-255"><a href="factor-analysis.html#cb23-255" aria-hidden="true" tabindex="-1"></a><span class="st">             occupation&#39;</span></span>
<span id="cb23-256"><a href="factor-analysis.html#cb23-256" aria-hidden="true" tabindex="-1"></a>fitIQ <span class="ot">&lt;-</span> <span class="fu">cfa</span>(modelIQ, <span class="at">data =</span> FamilyIQ, <span class="at">cluster =</span> <span class="st">&quot;family&quot;</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-257"><a href="factor-analysis.html#cb23-257" aria-hidden="true" tabindex="-1"></a>fitIQ</span>
<span id="cb23-258"><a href="factor-analysis.html#cb23-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-259"><a href="factor-analysis.html#cb23-259" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- bayesian confirmatory factor analysis</span></span>
<span id="cb23-260"><a href="factor-analysis.html#cb23-260" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;blavaan&quot;</span>)</span>
<span id="cb23-261"><a href="factor-analysis.html#cb23-261" aria-hidden="true" tabindex="-1"></a><span class="fu">dpriors</span>()[<span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;itheta&quot;</span>, <span class="st">&quot;ipsi&quot;</span>)]</span>
<span id="cb23-262"><a href="factor-analysis.html#cb23-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-263"><a href="factor-analysis.html#cb23-263" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb23-264"><a href="factor-analysis.html#cb23-264" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Bergh&quot;</span>)</span>
<span id="cb23-265"><a href="factor-analysis.html#cb23-265" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ EP + HP + DP + SP&#39;</span></span>
<span id="cb23-266"><a href="factor-analysis.html#cb23-266" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb23-267"><a href="factor-analysis.html#cb23-267" aria-hidden="true" tabindex="-1"></a>fitBCFA <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">burnin =</span> <span class="dv">2000</span>, <span class="at">sample =</span> <span class="dv">10000</span>, <span class="at">n.chains =</span> <span class="dv">2</span>)</span>
<span id="cb23-268"><a href="factor-analysis.html#cb23-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-269"><a href="factor-analysis.html#cb23-269" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitBCFA, <span class="at">pars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">plot.type =</span> <span class="st">&quot;trace&quot;</span>)</span>
<span id="cb23-270"><a href="factor-analysis.html#cb23-270" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitBCFA, <span class="at">pars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">plot.type =</span> <span class="st">&quot;autocorr&quot;</span>)</span>
<span id="cb23-271"><a href="factor-analysis.html#cb23-271" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitBCFA)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="CCT.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="path-analysis-and-structural-equation-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["AdvancedMeasurementTheoryNotebook.pdf", "AdvancedMeasurementTheoryNotebook.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
