<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Factor Analysis | Advanced Measurement Theory Course Notebook</title>
  <meta name="description" content="This is a Course Notebook for Advanced Measurement Theory (ERMA 8350)" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Factor Analysis | Advanced Measurement Theory Course Notebook" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a Course Notebook for Advanced Measurement Theory (ERMA 8350)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Factor Analysis | Advanced Measurement Theory Course Notebook" />
  
  <meta name="twitter:description" content="This is a Course Notebook for Advanced Measurement Theory (ERMA 8350)" />
  

<meta name="author" content="William M. Murrah" />


<meta name="date" content="2022-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="generalizability-theory.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Measurement Theory Notebook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction to the Course</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources-for-learning-r"><i class="fa fa-check"></i>Resources for Learning R</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-packages"><i class="fa fa-check"></i>R Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-these-notes"><i class="fa fa-check"></i>How To Use These Notes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="generalizability-theory.html"><a href="generalizability-theory.html"><i class="fa fa-check"></i><b>1</b> Generalizability Theory</a></li>
<li class="chapter" data-level="2" data-path="factor-analysis.html"><a href="factor-analysis.html"><i class="fa fa-check"></i><b>2</b> Factor Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="factor-analysis.html"><a href="factor-analysis.html#correlation-coefficient"><i class="fa fa-check"></i><b>2.1</b> Correlation Coefficient</a></li>
<li class="chapter" data-level="2.2" data-path="factor-analysis.html"><a href="factor-analysis.html#think-about-these-situations"><i class="fa fa-check"></i><b>2.2</b> Think about these situations</a></li>
<li class="chapter" data-level="2.3" data-path="factor-analysis.html"><a href="factor-analysis.html#solutions"><i class="fa fa-check"></i><b>2.3</b> Solutions</a></li>
<li class="chapter" data-level="2.4" data-path="factor-analysis.html"><a href="factor-analysis.html#principal-components-analysis"><i class="fa fa-check"></i><b>2.4</b> Principal Components Analysis</a></li>
<li class="chapter" data-level="2.5" data-path="factor-analysis.html"><a href="factor-analysis.html#factor-analysis-1"><i class="fa fa-check"></i><b>2.5</b> Factor Analysis</a></li>
<li class="chapter" data-level="2.6" data-path="factor-analysis.html"><a href="factor-analysis.html#components"><i class="fa fa-check"></i><b>2.6</b> Components</a></li>
<li class="chapter" data-level="2.7" data-path="factor-analysis.html"><a href="factor-analysis.html#pc-extraction"><i class="fa fa-check"></i><b>2.7</b> PC Extraction</a></li>
<li class="chapter" data-level="2.8" data-path="factor-analysis.html"><a href="factor-analysis.html#eigenvalues"><i class="fa fa-check"></i><b>2.8</b> Eigenvalues</a></li>
<li class="chapter" data-level="2.9" data-path="factor-analysis.html"><a href="factor-analysis.html#determining-the-number-of-factors"><i class="fa fa-check"></i><b>2.9</b> Determining the Number of Factors</a></li>
<li class="chapter" data-level="2.10" data-path="factor-analysis.html"><a href="factor-analysis.html#example-data"><i class="fa fa-check"></i><b>2.10</b> Example data</a></li>
<li class="chapter" data-level="2.11" data-path="factor-analysis.html"><a href="factor-analysis.html#kaiser"><i class="fa fa-check"></i><b>2.11</b> Kaiser</a></li>
<li class="chapter" data-level="2.12" data-path="factor-analysis.html"><a href="factor-analysis.html#scree-plot"><i class="fa fa-check"></i><b>2.12</b> Scree Plot</a></li>
<li class="chapter" data-level="2.13" data-path="factor-analysis.html"><a href="factor-analysis.html#horns-parallel-analysis"><i class="fa fa-check"></i><b>2.13</b> Horn’s Parallel Analysis</a></li>
<li class="chapter" data-level="2.14" data-path="factor-analysis.html"><a href="factor-analysis.html#another-example"><i class="fa fa-check"></i><b>2.14</b> Another example</a></li>
<li class="chapter" data-level="2.15" data-path="factor-analysis.html"><a href="factor-analysis.html#rotation"><i class="fa fa-check"></i><b>2.15</b> Rotation</a></li>
<li class="chapter" data-level="2.16" data-path="factor-analysis.html"><a href="factor-analysis.html#orthogonal-rotation"><i class="fa fa-check"></i><b>2.16</b> Orthogonal Rotation</a></li>
<li class="chapter" data-level="2.17" data-path="factor-analysis.html"><a href="factor-analysis.html#oblique-rotation"><i class="fa fa-check"></i><b>2.17</b> Oblique Rotation</a></li>
<li class="chapter" data-level="2.18" data-path="factor-analysis.html"><a href="factor-analysis.html#factor-matrices"><i class="fa fa-check"></i><b>2.18</b> Factor Matrices</a></li>
<li class="chapter" data-level="2.19" data-path="factor-analysis.html"><a href="factor-analysis.html#which-matrix-should-we-interpret"><i class="fa fa-check"></i><b>2.19</b> Which matrix should we interpret?</a></li>
<li class="chapter" data-level="2.20" data-path="factor-analysis.html"><a href="factor-analysis.html#which-variables-should-be-used-to-interpret-each-factor"><i class="fa fa-check"></i><b>2.20</b> Which variables should be used to interpret each factor?</a></li>
<li class="chapter" data-level="2.21" data-path="factor-analysis.html"><a href="factor-analysis.html#examples"><i class="fa fa-check"></i><b>2.21</b> Examples</a></li>
<li class="chapter" data-level="2.22" data-path="factor-analysis.html"><a href="factor-analysis.html#steps-in-factor-analysis"><i class="fa fa-check"></i><b>2.22</b> Steps in Factor Analysis</a></li>
<li class="chapter" data-level="2.23" data-path="factor-analysis.html"><a href="factor-analysis.html#tom-swifts-electric-factor-analysis-factory"><i class="fa fa-check"></i><b>2.23</b> Tom Swift’s Electric Factor Analysis Factory</a></li>
<li class="chapter" data-level="2.24" data-path="factor-analysis.html"><a href="factor-analysis.html#metal-boxes"><i class="fa fa-check"></i><b>2.24</b> Metal Boxes</a></li>
<li class="chapter" data-level="2.25" data-path="factor-analysis.html"><a href="factor-analysis.html#correlations"><i class="fa fa-check"></i><b>2.25</b> Correlations</a></li>
<li class="chapter" data-level="2.26" data-path="factor-analysis.html"><a href="factor-analysis.html#eigenvalues-1"><i class="fa fa-check"></i><b>2.26</b> Eigenvalues &gt; 1</a></li>
<li class="chapter" data-level="2.27" data-path="factor-analysis.html"><a href="factor-analysis.html#orthogonal-rotation-1"><i class="fa fa-check"></i><b>2.27</b> Orthogonal Rotation</a></li>
<li class="chapter" data-level="2.28" data-path="factor-analysis.html"><a href="factor-analysis.html#orthogonal-rotation-with-loadings-.70"><i class="fa fa-check"></i><b>2.28</b> Orthogonal Rotation with Loadings &gt; .70</a></li>
<li class="chapter" data-level="2.29" data-path="factor-analysis.html"><a href="factor-analysis.html#r-code-for-chapter-2"><i class="fa fa-check"></i><b>2.29</b> R Code for Chapter 2</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Measurement Theory Course Notebook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="factor-analysis" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Factor Analysis<a href="factor-analysis.html#factor-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="correlation-coefficient" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Correlation Coefficient<a href="factor-analysis.html#correlation-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>Pearson product-moment correlation</em>:</p>
<p><span class="math display">\[
r_{xy} = \frac{\Sigma_{n=1}^n (x_k - \bar{x})(y_i - \bar{y})}{\sqrt{\Sigma_{n=1}^n(x_i - \bar{x})^2} \sqrt{\Sigma_{n=1}^n(y_i - \bar{y})^2}} = \frac{s_{xy}}{s_x s_y}.
\]</span></p>
<p>The equation looks very daunting, until you see that it is just the covariance of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> divided by the product of their standard deviations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="factor-analysis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb1-2"><a href="factor-analysis.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;YouthDep&quot;</span>)</span>
<span id="cb1-3"><a href="factor-analysis.html#cb1-3" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb1-4"><a href="factor-analysis.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb1-5"><a href="factor-analysis.html#cb1-5" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb1-6"><a href="factor-analysis.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb1-7"><a href="factor-analysis.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(item1, item2)</span></code></pre></div>
<pre><code>     item2
item1    0    1
    0 1353  656
    1  115  166</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="factor-analysis.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ------ correlation coefficients</span></span>
<span id="cb3-2"><a href="factor-analysis.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;psych&quot;</span>)</span>
<span id="cb3-3"><a href="factor-analysis.html#cb3-3" aria-hidden="true" tabindex="-1"></a>tetcor <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(<span class="fu">cbind</span>(item1, item2))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="factor-analysis.html#cb4-1" aria-hidden="true" tabindex="-1"></a>tetcor</span></code></pre></div>
<pre><code>Call: tetrachoric(x = cbind(item1, item2))
tetrachoric correlation 
      item1 item2
item1 1.00       
item2 0.35  1.00 

 with tau of 
item1 item2 
 1.16  0.36 </code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="factor-analysis.html#cb6-1" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb6-2"><a href="factor-analysis.html#cb6-2" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb6-3"><a href="factor-analysis.html#cb6-3" aria-hidden="true" tabindex="-1"></a>polcor <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(<span class="fu">cbind</span>(item1, item2))</span>
<span id="cb6-4"><a href="factor-analysis.html#cb6-4" aria-hidden="true" tabindex="-1"></a>polcor</span></code></pre></div>
<pre><code>Call: polychoric(x = cbind(item1, item2))
Polychoric correlations 
      item1 item2
item1 1.00       
item2 0.33  1.00 

 with tau of 
         1   2
item1 1.16 2.3
item2 0.36 1.2</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="factor-analysis.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw.tetra</span>(<span class="at">r =</span> .<span class="dv">35</span>, <span class="at">t1 =</span> <span class="fl">1.16</span>, <span class="at">t2 =</span> .<span class="dv">36</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="factor-analysis.html#cb9-1" aria-hidden="true" tabindex="-1"></a>DepItems <span class="ot">&lt;-</span> YouthDep[,<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] </span>
<span id="cb9-2"><a href="factor-analysis.html#cb9-2" aria-hidden="true" tabindex="-1"></a>Depnum <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(DepItems) <span class="sc">-</span> <span class="dv">1</span>  <span class="do">## convert to numeric   </span></span>
<span id="cb9-3"><a href="factor-analysis.html#cb9-3" aria-hidden="true" tabindex="-1"></a>Rdep <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(Depnum)</span></code></pre></div>
</div>
<div id="think-about-these-situations" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Think about these situations<a href="factor-analysis.html#think-about-these-situations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What do you do when you have a large number of variables you are considering as predictors of a dependent variable?</p>
<ul>
<li>Often, subsets of these variables are measuring the same, or very similar things.</li>
<li>We might like to reduce the variables to a smaller number of predictors.</li>
</ul>
<p>What if you are developing a measurement scale and have a large number of items you think measure the same construct</p>
<ul>
<li>You might want to see how strongly the items are related to the construct.</li>
</ul>
</div>
<div id="solutions" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Solutions<a href="factor-analysis.html#solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Principal Components Analysis</p>
<ul>
<li>transforming the original variables into a new set of linear combinations (pricipal components).</li>
</ul></li>
<li><p>Factor Analysis</p>
<ul>
<li>setting up a mathematical model to estimate the number or factors</li>
</ul></li>
</ol>
</div>
<div id="principal-components-analysis" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Principal Components Analysis<a href="factor-analysis.html#principal-components-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Concerned with explaining variance-covariance structure of a set of variables.</li>
<li>PCA attempts to explain as much of the total variance among the observed variables as possible with a smaller number of components.</li>
<li>Because the variables are standardized prior to analysis, the total amount of variance available is the number of variables.</li>
<li>The goal is <strong>data reduction</strong> for subsequent analysis.</li>
<li>Variables <em>cause</em> components.</li>
<li>Components are not representative of any underlying theory.</li>
</ul>
</div>
<div id="factor-analysis-1" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Factor Analysis<a href="factor-analysis.html#factor-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The goal is understanding underlying constructs.</li>
<li>Uses a modified correlation matrix (reduced matrix)</li>
<li>factors <em>cause</em> the variables.</li>
<li>Factors represent theoretical constructs.</li>
<li>Focuses on the common variance of the variables, and purges the unique variance.</li>
</ul>
</div>
<div id="components" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Components<a href="factor-analysis.html#components" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The principal components partition the total variance (the sum of the variances of the original variables) by finding the linear combination of the variables that account for the maximum amount of variance:</p>
<p><span class="math display">\[
PC1 = a_{11}x_1 + a_{12}x_2 ... a_{1p}x_p,
\]</span>
This is repeated as many time as there are variables.</p>
</div>
<div id="pc-extraction" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> PC Extraction<a href="factor-analysis.html#pc-extraction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>draw pretty pictures on the board</p>
</div>
<div id="eigenvalues" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Eigenvalues<a href="factor-analysis.html#eigenvalues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Eigenvalues represent the variance in the variables explained by the success components.</p>
</div>
<div id="determining-the-number-of-factors" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Determining the Number of Factors<a href="factor-analysis.html#determining-the-number-of-factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Kaiser criterion: Retain only factors with eigenvalues &gt; 1. (generally accurate)</li>
<li>Scree plot: plot eigenvalues and drop factors after leveling off.</li>
<li>Parallel analysis: compare observed eigenvalues to parallel set of data from randomly generated data. Retain factors in original if eigenvalue is greater than random eigenvalue.</li>
<li>Factor meaningfulness is also very important to consider.</li>
</ol>
</div>
<div id="example-data" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Example data<a href="factor-analysis.html#example-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="factor-analysis.html#cb10-1" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb10-2"><a href="factor-analysis.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="st">1.00</span></span>
<span id="cb10-3"><a href="factor-analysis.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="st">0.70 1.00</span></span>
<span id="cb10-4"><a href="factor-analysis.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="st">0.65 0.66 1.00</span></span>
<span id="cb10-5"><a href="factor-analysis.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">0.62 0.63 0.60 1.00</span></span>
<span id="cb10-6"><a href="factor-analysis.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span></span>
<span id="cb10-7"><a href="factor-analysis.html#cb10-7" aria-hidden="true" tabindex="-1"></a>cormat <span class="ot">&lt;-</span> <span class="fu">getCov</span>(lower, <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;d1&quot;</span>, <span class="st">&quot;d2&quot;</span>, <span class="st">&quot;d3&quot;</span>, <span class="st">&quot;d4&quot;</span>))</span>
<span id="cb10-8"><a href="factor-analysis.html#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="factor-analysis.html#cb10-9" aria-hidden="true" tabindex="-1"></a>cormat</span></code></pre></div>
<pre><code>     d1   d2   d3   d4
d1 1.00 0.70 0.65 0.62
d2 0.70 1.00 0.66 0.63
d3 0.65 0.66 1.00 0.60
d4 0.62 0.63 0.60 1.00</code></pre>
</div>
<div id="kaiser" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Kaiser<a href="factor-analysis.html#kaiser" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Retain factors with eigenvalues greater than 1</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="factor-analysis.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(cormat)<span class="sc">$</span>values</span></code></pre></div>
<pre><code>[1] 2.9311792 0.4103921 0.3592372 0.2991916</code></pre>
</div>
<div id="scree-plot" class="section level2 hasAnchor" number="2.12">
<h2><span class="header-section-number">2.12</span> Scree Plot<a href="factor-analysis.html#scree-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="factor-analysis.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(cormat, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="horns-parallel-analysis" class="section level2 hasAnchor" number="2.13">
<h2><span class="header-section-number">2.13</span> Horn’s Parallel Analysis<a href="factor-analysis.html#horns-parallel-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="factor-analysis.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(cormat, <span class="at">fa =</span> <span class="st">&quot;pc&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  NA  and the number of components =  1 </code></pre>
</div>
<div id="another-example" class="section level2 hasAnchor" number="2.14">
<h2><span class="header-section-number">2.14</span> Another example<a href="factor-analysis.html#another-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="factor-analysis.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(Harman74.cor<span class="sc">$</span>cov, <span class="at">fa =</span> <span class="st">&quot;pc&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  NA  and the number of components =  2 </code></pre>
</div>
<div id="rotation" class="section level2 hasAnchor" number="2.15">
<h2><span class="header-section-number">2.15</span> Rotation<a href="factor-analysis.html#rotation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Principal components are derived to maximize the variance accounted for (data reduction).</li>
<li>Rotation is done to make the factors more interpretable (i.e. meaningful).</li>
<li>Two major classes of rotation:
<ul>
<li>Orthogonal - new factors are still uncorrelated, as were the initial factors.</li>
<li>Oblique - new factors are allowed to be correlated.</li>
</ul></li>
</ul>
<p>Essentially reallocates the loadings. The first factor may not be the one accounting for the most variance.</p>
</div>
<div id="orthogonal-rotation" class="section level2 hasAnchor" number="2.16">
<h2><span class="header-section-number">2.16</span> Orthogonal Rotation<a href="factor-analysis.html#orthogonal-rotation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p><strong>Quartimax</strong> - idea is to clean up the <em>variables</em>. Rotation done so each variable loads mainly on one factor. Problematic if there is a general factor on which most or all variables load on (think IQ).</p></li>
<li><p><strong>Varimax</strong> - to clean up <em>factors</em>. So each factor has high correlation with a smaller number of variables, low correlation with the other variables. Generally makes interpretation easier.</p></li>
</ol>
</div>
<div id="oblique-rotation" class="section level2 hasAnchor" number="2.17">
<h2><span class="header-section-number">2.17</span> Oblique Rotation<a href="factor-analysis.html#oblique-rotation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Often correlated factors are more reasonable.</li>
<li>Therefore, oblique rotation is often preferred.</li>
<li>But interpretation is more complicated.</li>
</ul>
</div>
<div id="factor-matrices" class="section level2 hasAnchor" number="2.18">
<h2><span class="header-section-number">2.18</span> Factor Matrices<a href="factor-analysis.html#factor-matrices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Factor pattern matrix:
<ul>
<li>includes <em>pattern coefficients</em> analogous to standardized partial regression coefficients.</li>
<li>Indicated the unique importance of a factor to a variable, holding other factors constant.</li>
</ul></li>
<li>Factor structure matrix:
<ul>
<li>includes <em>structure coefficients</em> which are simple correlations of the variables with the factors.</li>
</ul></li>
</ol>
</div>
<div id="which-matrix-should-we-interpret" class="section level2 hasAnchor" number="2.19">
<h2><span class="header-section-number">2.19</span> Which matrix should we interpret?<a href="factor-analysis.html#which-matrix-should-we-interpret" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>When orthogonal rotation is used interpret <em>structural coefficients</em> (but they are the same as pattern coefficients).</p></li>
<li><p>When oblique rotation is used pattern coefficients are preferred because they account for the correlation between the factors and they are parameters of the correlated factor model (which we will discuss next class).</p></li>
</ul>
</div>
<div id="which-variables-should-be-used-to-interpret-each-factor" class="section level2 hasAnchor" number="2.20">
<h2><span class="header-section-number">2.20</span> Which variables should be used to interpret each factor?<a href="factor-analysis.html#which-variables-should-be-used-to-interpret-each-factor" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The idea is to use only those variables that have a strong association with the factor.</li>
<li>Typical thresholds are |.30| or |.40|.</li>
<li>Content knowledge is critical.</li>
</ul>
</div>
<div id="examples" class="section level2 hasAnchor" number="2.21">
<h2><span class="header-section-number">2.21</span> Examples<a href="factor-analysis.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s look at some examples</p>
</div>
<div id="steps-in-factor-analysis" class="section level2 hasAnchor" number="2.22">
<h2><span class="header-section-number">2.22</span> Steps in Factor Analysis<a href="factor-analysis.html#steps-in-factor-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Choose extraction method
<ul>
<li>So far we’ve focused on PCA</li>
</ul></li>
<li>Determine the number of components/factors
<ul>
<li>Kaiser method: eigenvalues &gt; 1</li>
<li>Scree plot: All components before leveling off</li>
<li>Horn’s parallel analysis: components/factors greater than simulated values from random numbers</li>
</ul></li>
<li>Rotate Factors
<ul>
<li>Orthogonal</li>
<li>Oblique</li>
</ul></li>
<li>Interpret Components/Factors</li>
</ol>
</div>
<div id="tom-swifts-electric-factor-analysis-factory" class="section level2 hasAnchor" number="2.23">
<h2><span class="header-section-number">2.23</span> Tom Swift’s Electric Factor Analysis Factory<a href="factor-analysis.html#tom-swifts-electric-factor-analysis-factory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Little Jiffy” method of factor analysis</p>
<ol style="list-style-type: decimal">
<li>Extraction method : PCA</li>
<li>Number of factors: eigenvalues &gt; 1</li>
<li>Rotation: orthogonal(varimax)</li>
<li>Interpretation</li>
</ol>
</div>
<div id="metal-boxes" class="section level2 hasAnchor" number="2.24">
<h2><span class="header-section-number">2.24</span> Metal Boxes<a href="factor-analysis.html#metal-boxes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<caption><span id="tab:unnamed-chunk-10">Table 2.1: </span>Functional Definitions of Tom Swift’s Original 11 Variables</caption>
<thead>
<tr class="header">
<th align="left">Dimension</th>
<th align="left">Derivation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Thickness</td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">Width</td>
<td align="left">y</td>
</tr>
<tr class="odd">
<td align="left">Length</td>
<td align="left">z</td>
</tr>
<tr class="even">
<td align="left">Volume</td>
<td align="left">xyz</td>
</tr>
<tr class="odd">
<td align="left">Density</td>
<td align="left">d</td>
</tr>
<tr class="even">
<td align="left">Weight</td>
<td align="left">xyzd</td>
</tr>
<tr class="odd">
<td align="left">Surface area</td>
<td align="left">2(xy + xz + yz)</td>
</tr>
<tr class="even">
<td align="left">Cross-section</td>
<td align="left">yz</td>
</tr>
<tr class="odd">
<td align="left">Edge length</td>
<td align="left">4(x + y + z)</td>
</tr>
<tr class="even">
<td align="left">Diagonal length</td>
<td align="left">(x^2)</td>
</tr>
<tr class="odd">
<td align="left">Cost/lb</td>
<td align="left">c</td>
</tr>
</tbody>
</table>
<pre><code>&#39;data.frame&#39;:   63 obs. of  11 variables:
 $ thick   : num  1.362 2.385 3.101 0.934 0.845 ...
 $ width   : num  1.71 2.83 4.32 3.2 3.84 ...
 $ length  : num  2.93 5.01 5.99 4.15 4.09 ...
 $ volume  : num  6.02 30.2 72.01 11.78 16.1 ...
 $ density : int  10 7 16 22 11 16 11 21 6 13 ...
 $ weight  : num  60 210 1152 264 176 ...
 $ surface : num  22 62.1 108.2 38 48 ...
 $ crosssec: num  5.87 15.06 23.53 12.02 16.13 ...
 $ edge    : num  23.9 39.9 51.5 31.9 36.1 ...
 $ diagonal: num  196 1444 3721 676 1089 ...
 $ cost    : num  4.48 2.37 9.77 22.21 15.86 ...</code></pre>
</div>
<div id="correlations" class="section level2 hasAnchor" number="2.25">
<h2><span class="header-section-number">2.25</span> Correlations<a href="factor-analysis.html#correlations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<caption><span id="tab:unnamed-chunk-12">Table 2.2: </span>Correlations between dimensions</caption>
<colgroup>
<col width="10%" />
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="9%" />
<col width="7%" />
<col width="9%" />
<col width="10%" />
<col width="6%" />
<col width="10%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">thick</th>
<th align="right">width</th>
<th align="right">length</th>
<th align="right">volume</th>
<th align="right">density</th>
<th align="right">weight</th>
<th align="right">surface</th>
<th align="right">crosssec</th>
<th align="right">edge</th>
<th align="right">diagonal</th>
<th align="right">cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">thick</td>
<td align="right">1.00</td>
<td align="right">0.49</td>
<td align="right">0.24</td>
<td align="right">0.84</td>
<td align="right">-0.13</td>
<td align="right">0.59</td>
<td align="right">0.74</td>
<td align="right">0.46</td>
<td align="right">0.61</td>
<td align="right">0.51</td>
<td align="right">-0.02</td>
</tr>
<tr class="even">
<td align="left">width</td>
<td align="right">0.49</td>
<td align="right">1.00</td>
<td align="right">0.61</td>
<td align="right">0.77</td>
<td align="right">-0.15</td>
<td align="right">0.55</td>
<td align="right">0.87</td>
<td align="right">0.92</td>
<td align="right">0.88</td>
<td align="right">0.78</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">length</td>
<td align="right">0.24</td>
<td align="right">0.61</td>
<td align="right">1.00</td>
<td align="right">0.58</td>
<td align="right">-0.02</td>
<td align="right">0.45</td>
<td align="right">0.72</td>
<td align="right">0.83</td>
<td align="right">0.84</td>
<td align="right">0.86</td>
<td align="right">-0.02</td>
</tr>
<tr class="even">
<td align="left">volume</td>
<td align="right">0.84</td>
<td align="right">0.77</td>
<td align="right">0.58</td>
<td align="right">1.00</td>
<td align="right">-0.22</td>
<td align="right">0.65</td>
<td align="right">0.97</td>
<td align="right">0.81</td>
<td align="right">0.87</td>
<td align="right">0.85</td>
<td align="right">-0.11</td>
</tr>
<tr class="odd">
<td align="left">density</td>
<td align="right">-0.13</td>
<td align="right">-0.15</td>
<td align="right">-0.02</td>
<td align="right">-0.22</td>
<td align="right">1.00</td>
<td align="right">0.44</td>
<td align="right">-0.20</td>
<td align="right">-0.15</td>
<td align="right">-0.15</td>
<td align="right">-0.18</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="left">weight</td>
<td align="right">0.59</td>
<td align="right">0.55</td>
<td align="right">0.45</td>
<td align="right">0.65</td>
<td align="right">0.44</td>
<td align="right">1.00</td>
<td align="right">0.65</td>
<td align="right">0.56</td>
<td align="right">0.61</td>
<td align="right">0.57</td>
<td align="right">0.24</td>
</tr>
<tr class="odd">
<td align="left">surface</td>
<td align="right">0.74</td>
<td align="right">0.87</td>
<td align="right">0.72</td>
<td align="right">0.97</td>
<td align="right">-0.20</td>
<td align="right">0.65</td>
<td align="right">1.00</td>
<td align="right">0.92</td>
<td align="right">0.97</td>
<td align="right">0.91</td>
<td align="right">-0.07</td>
</tr>
<tr class="even">
<td align="left">crosssec</td>
<td align="right">0.46</td>
<td align="right">0.92</td>
<td align="right">0.83</td>
<td align="right">0.81</td>
<td align="right">-0.15</td>
<td align="right">0.56</td>
<td align="right">0.92</td>
<td align="right">1.00</td>
<td align="right">0.96</td>
<td align="right">0.93</td>
<td align="right">-0.03</td>
</tr>
<tr class="odd">
<td align="left">edge</td>
<td align="right">0.61</td>
<td align="right">0.88</td>
<td align="right">0.84</td>
<td align="right">0.87</td>
<td align="right">-0.15</td>
<td align="right">0.61</td>
<td align="right">0.97</td>
<td align="right">0.96</td>
<td align="right">1.00</td>
<td align="right">0.92</td>
<td align="right">-0.04</td>
</tr>
<tr class="even">
<td align="left">diagonal</td>
<td align="right">0.51</td>
<td align="right">0.78</td>
<td align="right">0.86</td>
<td align="right">0.85</td>
<td align="right">-0.18</td>
<td align="right">0.57</td>
<td align="right">0.91</td>
<td align="right">0.93</td>
<td align="right">0.92</td>
<td align="right">1.00</td>
<td align="right">-0.12</td>
</tr>
<tr class="odd">
<td align="left">cost</td>
<td align="right">-0.02</td>
<td align="right">0.03</td>
<td align="right">-0.02</td>
<td align="right">-0.11</td>
<td align="right">0.62</td>
<td align="right">0.24</td>
<td align="right">-0.07</td>
<td align="right">-0.03</td>
<td align="right">-0.04</td>
<td align="right">-0.12</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
</div>
<div id="eigenvalues-1" class="section level2 hasAnchor" number="2.26">
<h2><span class="header-section-number">2.26</span> Eigenvalues &gt; 1<a href="factor-analysis.html#eigenvalues-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="orthogonal-rotation-1" class="section level2 hasAnchor" number="2.27">
<h2><span class="header-section-number">2.27</span> Orthogonal Rotation<a href="factor-analysis.html#orthogonal-rotation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>
Loadings:
         RC1    RC3    RC2    RC5    RC4   
thick            0.968                     
width                          0.734       
length    0.986                            
volume           0.754                     
density                 0.864              
weight                                     
surface   0.703                            
crosssec  0.829                            
edge      0.819                            
diagonal  0.875                            
cost                                  0.955

                 RC1   RC3   RC2   RC5   RC4
SS loadings    4.425 2.662 1.318 1.225 1.106
Proportion Var 0.402 0.242 0.120 0.111 0.101
Cumulative Var 0.402 0.644 0.764 0.876 0.976</code></pre>
</div>
<div id="orthogonal-rotation-with-loadings-.70" class="section level2 hasAnchor" number="2.28">
<h2><span class="header-section-number">2.28</span> Orthogonal Rotation with Loadings &gt; .70<a href="factor-analysis.html#orthogonal-rotation-with-loadings-.70" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<pre><code>
Loadings:
         RC1    RC3    RC2   
thick            0.947       
width     0.801              
length    0.936              
volume           0.744       
density                 0.930
weight                       
surface   0.792              
crosssec  0.942              
edge      0.892              
diagonal  0.905              
cost                    0.841

                 RC1   RC3   RC2
SS loadings    5.298 2.699 1.868
Proportion Var 0.482 0.245 0.170
Cumulative Var 0.482 0.727 0.897</code></pre>
</div>
<div id="r-code-for-chapter-2" class="section level2 hasAnchor" number="2.29">
<h2><span class="header-section-number">2.29</span> R Code for Chapter 2<a href="factor-analysis.html#r-code-for-chapter-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="factor-analysis.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------- Chapter 2: Factor Analysis ------------------</span></span>
<span id="cb22-2"><a href="factor-analysis.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb22-3"><a href="factor-analysis.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;YouthDep&quot;</span>)</span>
<span id="cb22-4"><a href="factor-analysis.html#cb22-4" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb22-5"><a href="factor-analysis.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb22-6"><a href="factor-analysis.html#cb22-6" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb22-7"><a href="factor-analysis.html#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(item2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb22-8"><a href="factor-analysis.html#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(item1, item2)</span>
<span id="cb22-9"><a href="factor-analysis.html#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="factor-analysis.html#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ------ correlation coefficients</span></span>
<span id="cb22-11"><a href="factor-analysis.html#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;psych&quot;</span>)</span>
<span id="cb22-12"><a href="factor-analysis.html#cb22-12" aria-hidden="true" tabindex="-1"></a>tetcor <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(<span class="fu">cbind</span>(item1, item2))</span>
<span id="cb22-13"><a href="factor-analysis.html#cb22-13" aria-hidden="true" tabindex="-1"></a>tetcor</span>
<span id="cb22-14"><a href="factor-analysis.html#cb22-14" aria-hidden="true" tabindex="-1"></a>item1 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">1</span>]</span>
<span id="cb22-15"><a href="factor-analysis.html#cb22-15" aria-hidden="true" tabindex="-1"></a>item2 <span class="ot">&lt;-</span> YouthDep[, <span class="dv">14</span>]</span>
<span id="cb22-16"><a href="factor-analysis.html#cb22-16" aria-hidden="true" tabindex="-1"></a>polcor <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(<span class="fu">cbind</span>(item1, item2))</span>
<span id="cb22-17"><a href="factor-analysis.html#cb22-17" aria-hidden="true" tabindex="-1"></a>polcor</span>
<span id="cb22-18"><a href="factor-analysis.html#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="factor-analysis.html#cb22-19" aria-hidden="true" tabindex="-1"></a>DepItems <span class="ot">&lt;-</span> YouthDep[,<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>] </span>
<span id="cb22-20"><a href="factor-analysis.html#cb22-20" aria-hidden="true" tabindex="-1"></a>Depnum <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(DepItems) <span class="sc">-</span> <span class="dv">1</span>  <span class="do">## convert to numeric   </span></span>
<span id="cb22-21"><a href="factor-analysis.html#cb22-21" aria-hidden="true" tabindex="-1"></a>Rdep <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(Depnum)</span>
<span id="cb22-22"><a href="factor-analysis.html#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="factor-analysis.html#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Rmotivation&quot;</span>)</span>
<span id="cb22-24"><a href="factor-analysis.html#cb22-24" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;ext|int&quot;</span>, <span class="fu">colnames</span>(Rmotivation)) </span>
<span id="cb22-25"><a href="factor-analysis.html#cb22-25" aria-hidden="true" tabindex="-1"></a>Rmotivation1 <span class="ot">&lt;-</span> Rmotivation[, vind]</span>
<span id="cb22-26"><a href="factor-analysis.html#cb22-26" aria-hidden="true" tabindex="-1"></a>Rmot1 <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(Rmotivation1, <span class="at">smooth =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-27"><a href="factor-analysis.html#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">round</span>(<span class="fu">eigen</span>(Rmot1<span class="sc">$</span>rho)<span class="sc">$</span>values, <span class="dv">3</span>))</span>
<span id="cb22-28"><a href="factor-analysis.html#cb22-28" aria-hidden="true" tabindex="-1"></a>Rmot <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(Rmotivation1)</span>
<span id="cb22-29"><a href="factor-analysis.html#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(<span class="fu">round</span>(<span class="fu">eigen</span>(Rmot<span class="sc">$</span>rho)<span class="sc">$</span>values, <span class="dv">3</span>))</span>
<span id="cb22-30"><a href="factor-analysis.html#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="factor-analysis.html#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- exploratory factor analysis </span></span>
<span id="cb22-32"><a href="factor-analysis.html#cb22-32" aria-hidden="true" tabindex="-1"></a>motFA <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmot<span class="sc">$</span>rho, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;none&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb22-33"><a href="factor-analysis.html#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(motFA<span class="sc">$</span>loadings, <span class="at">cutoff =</span> <span class="fl">0.2</span>)</span>
<span id="cb22-34"><a href="factor-analysis.html#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(motFA<span class="sc">$</span>communality, <span class="dv">2</span>)</span>
<span id="cb22-35"><a href="factor-analysis.html#cb22-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-36"><a href="factor-analysis.html#cb22-36" aria-hidden="true" tabindex="-1"></a>motFA2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmot<span class="sc">$</span>rho, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;varimax&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb22-37"><a href="factor-analysis.html#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(motFA<span class="sc">$</span>loadings, <span class="at">asp =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.9</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.9</span>), <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Factor 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Factor 2&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Loadings Plot&quot;</span>)</span>
<span id="cb22-38"><a href="factor-analysis.html#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(motFA<span class="sc">$</span>loadings, <span class="at">labels =</span> <span class="fu">rownames</span>(motFA<span class="sc">$</span>loadings), <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb22-39"><a href="factor-analysis.html#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;lightgray&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb22-40"><a href="factor-analysis.html#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(motFA2<span class="sc">$</span>loadings, <span class="at">labels =</span> <span class="fu">rownames</span>(motFA2<span class="sc">$</span>loadings), <span class="at">col =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb22-41"><a href="factor-analysis.html#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;rotated&quot;</span>, <span class="st">&quot;unrotated&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>), <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb22-42"><a href="factor-analysis.html#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="factor-analysis.html#cb22-43" aria-hidden="true" tabindex="-1"></a>Rmot2 <span class="ot">&lt;-</span> <span class="fu">tetrachoric</span>(Rmotivation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">36</span>])</span>
<span id="cb22-44"><a href="factor-analysis.html#cb22-44" aria-hidden="true" tabindex="-1"></a>motFA3 <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmot2<span class="sc">$</span>rho, <span class="at">nfactors =</span> <span class="dv">3</span>, <span class="at">rotate =</span> <span class="st">&quot;oblimin&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb22-45"><a href="factor-analysis.html#cb22-45" aria-hidden="true" tabindex="-1"></a>motFA3<span class="sc">$</span>loadings</span>
<span id="cb22-46"><a href="factor-analysis.html#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(motFA3<span class="sc">$</span>Phi, <span class="dv">3</span>)</span>
<span id="cb22-47"><a href="factor-analysis.html#cb22-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-48"><a href="factor-analysis.html#cb22-48" aria-hidden="true" tabindex="-1"></a>motFA2 <span class="ot">&lt;-</span> <span class="fu">fa</span>(Rmotivation1, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">rotate =</span> <span class="st">&quot;varimax&quot;</span>, <span class="at">cor =</span> <span class="st">&quot;tet&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">scores =</span> <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb22-49"><a href="factor-analysis.html#cb22-49" aria-hidden="true" tabindex="-1"></a>             <span class="at">missing =</span> <span class="cn">TRUE</span>, <span class="at">impute =</span> <span class="st">&quot;median&quot;</span>)</span>
<span id="cb22-50"><a href="factor-analysis.html#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(motFA2<span class="sc">$</span>scores)</span>
<span id="cb22-51"><a href="factor-analysis.html#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="factor-analysis.html#cb22-52" aria-hidden="true" tabindex="-1"></a>Rdep <span class="ot">&lt;-</span> <span class="fu">polychoric</span>(Depnum)<span class="sc">$</span>rho</span>
<span id="cb22-53"><a href="factor-analysis.html#cb22-53" aria-hidden="true" tabindex="-1"></a>evals <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Rdep)<span class="sc">$</span>values</span>
<span id="cb22-54"><a href="factor-analysis.html#cb22-54" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(Rdep, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-55"><a href="factor-analysis.html#cb22-55" aria-hidden="true" tabindex="-1"></a>(evals<span class="sc">/</span><span class="fu">sum</span>(evals)<span class="sc">*</span><span class="dv">100</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb22-56"><a href="factor-analysis.html#cb22-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-57"><a href="factor-analysis.html#cb22-57" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-58"><a href="factor-analysis.html#cb22-58" aria-hidden="true" tabindex="-1"></a>resPA <span class="ot">&lt;-</span> <span class="fu">fa.parallel</span>(Depnum, <span class="at">fa =</span> <span class="st">&quot;pc&quot;</span>, <span class="at">cor =</span> <span class="st">&quot;poly&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)  </span>
<span id="cb22-59"><a href="factor-analysis.html#cb22-59" aria-hidden="true" tabindex="-1"></a>resvss <span class="ot">&lt;-</span> <span class="fu">vss</span>(Rdep, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">n.obs =</span> <span class="fu">nrow</span>(Depnum), <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-60"><a href="factor-analysis.html#cb22-60" aria-hidden="true" tabindex="-1"></a>resvss</span>
<span id="cb22-61"><a href="factor-analysis.html#cb22-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-62"><a href="factor-analysis.html#cb22-62" aria-hidden="true" tabindex="-1"></a>fadep <span class="ot">&lt;-</span> <span class="fu">fa</span>(Depnum, <span class="dv">1</span>, <span class="at">cor =</span> <span class="st">&quot;poly&quot;</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>)</span>
<span id="cb22-63"><a href="factor-analysis.html#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fadep)</span>
<span id="cb22-64"><a href="factor-analysis.html#cb22-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-65"><a href="factor-analysis.html#cb22-65" aria-hidden="true" tabindex="-1"></a>resnf <span class="ot">&lt;-</span> <span class="fu">nfactors</span>(Depnum, <span class="at">n =</span> <span class="dv">8</span>, <span class="at">fm =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">cor =</span> <span class="st">&quot;poly&quot;</span>)</span>
<span id="cb22-66"><a href="factor-analysis.html#cb22-66" aria-hidden="true" tabindex="-1"></a>resnf</span>
<span id="cb22-67"><a href="factor-analysis.html#cb22-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-68"><a href="factor-analysis.html#cb22-68" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- Bayesian exploratory factor analysis</span></span>
<span id="cb22-69"><a href="factor-analysis.html#cb22-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb22-70"><a href="factor-analysis.html#cb22-70" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;corrplot&quot;</span>)</span>
<span id="cb22-71"><a href="factor-analysis.html#cb22-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;BayesFM&quot;</span>)</span>
<span id="cb22-72"><a href="factor-analysis.html#cb22-72" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Privacy&quot;</span>)</span>
<span id="cb22-73"><a href="factor-analysis.html#cb22-73" aria-hidden="true" tabindex="-1"></a>Privstd <span class="ot">&lt;-</span> <span class="fu">scale</span>(Privacy)</span>
<span id="cb22-74"><a href="factor-analysis.html#cb22-74" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(Privstd))</span>
<span id="cb22-75"><a href="factor-analysis.html#cb22-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-76"><a href="factor-analysis.html#cb22-76" aria-hidden="true" tabindex="-1"></a>Nid <span class="ot">&lt;-</span> <span class="dv">2</span>              <span class="do">## minimum number of variables per factor</span></span>
<span id="cb22-77"><a href="factor-analysis.html#cb22-77" aria-hidden="true" tabindex="-1"></a>pmax <span class="ot">&lt;-</span> <span class="fu">trunc</span>(<span class="fu">ncol</span>(Privstd)<span class="sc">/</span>Nid)   <span class="do">## maximum number of factors</span></span>
<span id="cb22-78"><a href="factor-analysis.html#cb22-78" aria-hidden="true" tabindex="-1"></a>pmax</span>
<span id="cb22-79"><a href="factor-analysis.html#cb22-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-80"><a href="factor-analysis.html#cb22-80" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-81"><a href="factor-analysis.html#cb22-81" aria-hidden="true" tabindex="-1"></a>Rsim <span class="ot">&lt;-</span> <span class="fu">simul.R.prior</span>(pmax, <span class="at">nu0 =</span> pmax <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>))</span>
<span id="cb22-82"><a href="factor-analysis.html#cb22-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Rsim)</span>
<span id="cb22-83"><a href="factor-analysis.html#cb22-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-84"><a href="factor-analysis.html#cb22-84" aria-hidden="true" tabindex="-1"></a>Ksim <span class="ot">&lt;-</span> <span class="fu">simul.nfac.prior</span>(<span class="at">nvar =</span> <span class="fu">ncol</span>(Privstd), <span class="at">Nid =</span> Nid, <span class="at">Kmax =</span> pmax, <span class="at">kappa =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">2</span>, .<span class="dv">5</span>, <span class="dv">1</span>))</span>
<span id="cb22-85"><a href="factor-analysis.html#cb22-85" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Ksim)</span>
<span id="cb22-86"><a href="factor-analysis.html#cb22-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-87"><a href="factor-analysis.html#cb22-87" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb22-88"><a href="factor-analysis.html#cb22-88" aria-hidden="true" tabindex="-1"></a>fitbefa <span class="ot">&lt;-</span> <span class="fu">befa</span>(Privstd, <span class="at">Nid =</span> <span class="dv">2</span>, <span class="at">Kmax =</span> pmax, <span class="at">nu0 =</span> <span class="dv">10</span>, <span class="at">kappa =</span> <span class="fl">0.2</span>, <span class="at">kappa0 =</span> <span class="fl">0.1</span>, <span class="at">xi0 =</span> <span class="fl">0.1</span>,</span>
<span id="cb22-89"><a href="factor-analysis.html#cb22-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">burnin =</span> <span class="dv">5000</span>, <span class="at">iter =</span> <span class="dv">50000</span>)</span>
<span id="cb22-90"><a href="factor-analysis.html#cb22-90" aria-hidden="true" tabindex="-1"></a>fitbefa <span class="ot">&lt;-</span> <span class="fu">post.column.switch</span>(fitbefa)   <span class="do">## column reordering</span></span>
<span id="cb22-91"><a href="factor-analysis.html#cb22-91" aria-hidden="true" tabindex="-1"></a>fitbefa <span class="ot">&lt;-</span> <span class="fu">post.sign.switch</span>(fitbefa)     <span class="do">## sign switching</span></span>
<span id="cb22-92"><a href="factor-analysis.html#cb22-92" aria-hidden="true" tabindex="-1"></a>sumbefa <span class="ot">&lt;-</span> <span class="fu">summary</span>(fitbefa)</span>
<span id="cb22-93"><a href="factor-analysis.html#cb22-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-94"><a href="factor-analysis.html#cb22-94" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- confirmatory factor analysis</span></span>
<span id="cb22-95"><a href="factor-analysis.html#cb22-95" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb22-96"><a href="factor-analysis.html#cb22-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lavaan&quot;</span>)</span>
<span id="cb22-97"><a href="factor-analysis.html#cb22-97" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Rmotivation&quot;</span>)</span>
<span id="cb22-98"><a href="factor-analysis.html#cb22-98" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;ext|int&quot;</span>, <span class="fu">colnames</span>(Rmotivation)) <span class="do">## ext/int items</span></span>
<span id="cb22-99"><a href="factor-analysis.html#cb22-99" aria-hidden="true" tabindex="-1"></a>Rmot <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Rmotivation[, vind])</span>
<span id="cb22-100"><a href="factor-analysis.html#cb22-100" aria-hidden="true" tabindex="-1"></a>mot_model <span class="ot">&lt;-</span> <span class="st">&#39; </span></span>
<span id="cb22-101"><a href="factor-analysis.html#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 + ext5 + ext6 + </span></span>
<span id="cb22-102"><a href="factor-analysis.html#cb22-102" aria-hidden="true" tabindex="-1"></a><span class="st">                ext7 + ext8 + ext9 + ext10 + ext11 + ext12      </span></span>
<span id="cb22-103"><a href="factor-analysis.html#cb22-103" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 + int5&#39;</span></span>
<span id="cb22-104"><a href="factor-analysis.html#cb22-104" aria-hidden="true" tabindex="-1"></a>fitMot <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model, <span class="at">data =</span> Rmot, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot))</span>
<span id="cb22-105"><a href="factor-analysis.html#cb22-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-106"><a href="factor-analysis.html#cb22-106" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;semPlot&quot;</span>)</span>
<span id="cb22-107"><a href="factor-analysis.html#cb22-107" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="fl">4.5</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb22-108"><a href="factor-analysis.html#cb22-108" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">nCharNodes =</span> <span class="dv">4</span>)</span>
<span id="cb22-109"><a href="factor-analysis.html#cb22-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-110"><a href="factor-analysis.html#cb22-110" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>theta</span>
<span id="cb22-111"><a href="factor-analysis.html#cb22-111" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>lambda</span>
<span id="cb22-112"><a href="factor-analysis.html#cb22-112" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>)<span class="sc">$</span>lambda</span>
<span id="cb22-113"><a href="factor-analysis.html#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>)<span class="sc">$</span>psi</span>
<span id="cb22-114"><a href="factor-analysis.html#cb22-114" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(fitMot, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>)<span class="sc">$</span>psi</span>
<span id="cb22-115"><a href="factor-analysis.html#cb22-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-116"><a href="factor-analysis.html#cb22-116" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitMot, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-117"><a href="factor-analysis.html#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitMot, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-118"><a href="factor-analysis.html#cb22-118" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitMot)[<span class="dv">5</span>,]</span>
<span id="cb22-119"><a href="factor-analysis.html#cb22-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-120"><a href="factor-analysis.html#cb22-120" aria-hidden="true" tabindex="-1"></a>mot_model2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb22-121"><a href="factor-analysis.html#cb22-121" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 + ext6 + ext7 + </span></span>
<span id="cb22-122"><a href="factor-analysis.html#cb22-122" aria-hidden="true" tabindex="-1"></a><span class="st">                ext8 + ext9 + ext10 + ext11 + ext12</span></span>
<span id="cb22-123"><a href="factor-analysis.html#cb22-123" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 + int5&#39;</span></span>
<span id="cb22-124"><a href="factor-analysis.html#cb22-124" aria-hidden="true" tabindex="-1"></a>fitMot2 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model2, <span class="at">data =</span> Rmot, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot)[<span class="sc">-</span><span class="dv">5</span>])</span>
<span id="cb22-125"><a href="factor-analysis.html#cb22-125" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">35</span>)</span>
<span id="cb22-126"><a href="factor-analysis.html#cb22-126" aria-hidden="true" tabindex="-1"></a>Rmot2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Rmotivation[, vind])</span>
<span id="cb22-127"><a href="factor-analysis.html#cb22-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-128"><a href="factor-analysis.html#cb22-128" aria-hidden="true" tabindex="-1"></a>mot_model3 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb22-129"><a href="factor-analysis.html#cb22-129" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 </span></span>
<span id="cb22-130"><a href="factor-analysis.html#cb22-130" aria-hidden="true" tabindex="-1"></a><span class="st">  hybrid =~ hyb1 + hyb2 + hyb3 + hyb4              </span></span>
<span id="cb22-131"><a href="factor-analysis.html#cb22-131" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 </span></span>
<span id="cb22-132"><a href="factor-analysis.html#cb22-132" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ extrinsic + hybrid + intrinsic&#39;</span></span>
<span id="cb22-133"><a href="factor-analysis.html#cb22-133" aria-hidden="true" tabindex="-1"></a>fitMot3 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model3, <span class="at">data =</span> Rmot2, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot2))</span>
<span id="cb22-134"><a href="factor-analysis.html#cb22-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-135"><a href="factor-analysis.html#cb22-135" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitMot3, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="dv">5</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb22-136"><a href="factor-analysis.html#cb22-136" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">nCharNodes =</span> <span class="dv">4</span>)</span>
<span id="cb22-137"><a href="factor-analysis.html#cb22-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-138"><a href="factor-analysis.html#cb22-138" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitMot3, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-139"><a href="factor-analysis.html#cb22-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-140"><a href="factor-analysis.html#cb22-140" aria-hidden="true" tabindex="-1"></a>vind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">13</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">32</span><span class="sc">:</span><span class="dv">35</span>, <span class="dv">39</span><span class="sc">:</span><span class="dv">41</span>)</span>
<span id="cb22-141"><a href="factor-analysis.html#cb22-141" aria-hidden="true" tabindex="-1"></a>Rmot3 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Rmotivation[, vind])</span>
<span id="cb22-142"><a href="factor-analysis.html#cb22-142" aria-hidden="true" tabindex="-1"></a>mot_model4 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb22-143"><a href="factor-analysis.html#cb22-143" aria-hidden="true" tabindex="-1"></a><span class="st">  extrinsic  =~ ext1 + ext2 + ext3 + ext4 </span></span>
<span id="cb22-144"><a href="factor-analysis.html#cb22-144" aria-hidden="true" tabindex="-1"></a><span class="st">  hybrid =~ hyb1 + hyb2 + hyb3 + hyb4              </span></span>
<span id="cb22-145"><a href="factor-analysis.html#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="st">  intrinsic =~  int1 + int2 + int3 + int4 </span></span>
<span id="cb22-146"><a href="factor-analysis.html#cb22-146" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation =~ extrinsic + hybrid + intrinsic</span></span>
<span id="cb22-147"><a href="factor-analysis.html#cb22-147" aria-hidden="true" tabindex="-1"></a><span class="st">  motivation ~ npkgs + phd&#39;</span></span>
<span id="cb22-148"><a href="factor-analysis.html#cb22-148" aria-hidden="true" tabindex="-1"></a>fitMot4 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(mot_model4, <span class="at">data =</span> Rmot3, <span class="at">ordered =</span> <span class="fu">names</span>(Rmot3[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]))</span>
<span id="cb22-149"><a href="factor-analysis.html#cb22-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-150"><a href="factor-analysis.html#cb22-150" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitMot4, <span class="at">what =</span> <span class="st">&quot;std&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="dv">5</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb22-151"><a href="factor-analysis.html#cb22-151" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>, <span class="at">nCharNodes =</span> <span class="dv">4</span>)</span>
<span id="cb22-152"><a href="factor-analysis.html#cb22-152" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitMot4)[<span class="dv">16</span><span class="sc">:</span><span class="dv">17</span>,]</span>
<span id="cb22-153"><a href="factor-analysis.html#cb22-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-154"><a href="factor-analysis.html#cb22-154" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;semTools&quot;</span>)</span>
<span id="cb22-155"><a href="factor-analysis.html#cb22-155" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Bergh&quot;</span>)</span>
<span id="cb22-156"><a href="factor-analysis.html#cb22-156" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ EP + HP + DP + SP&#39;</span></span>
<span id="cb22-157"><a href="factor-analysis.html#cb22-157" aria-hidden="true" tabindex="-1"></a>minvfit1 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-158"><a href="factor-analysis.html#cb22-158" aria-hidden="true" tabindex="-1"></a>minvfit2 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, </span>
<span id="cb22-159"><a href="factor-analysis.html#cb22-159" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>), <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-160"><a href="factor-analysis.html#cb22-160" aria-hidden="true" tabindex="-1"></a>minvfit3 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, </span>
<span id="cb22-161"><a href="factor-analysis.html#cb22-161" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>), <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-162"><a href="factor-analysis.html#cb22-162" aria-hidden="true" tabindex="-1"></a>minvfit4 <span class="ot">&lt;-</span> <span class="fu">measEq.syntax</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, </span>
<span id="cb22-163"><a href="factor-analysis.html#cb22-163" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>, <span class="st">&quot;means&quot;</span>), <span class="at">return.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-164"><a href="factor-analysis.html#cb22-164" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(minvfit1, minvfit2, minvfit3, minvfit4)</span>
<span id="cb22-165"><a href="factor-analysis.html#cb22-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-166"><a href="factor-analysis.html#cb22-166" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ c(v1,v1)*EP + c(v2,v2)*HP + c(v3,v3)*DP + SP&#39;</span></span>
<span id="cb22-167"><a href="factor-analysis.html#cb22-167" aria-hidden="true" tabindex="-1"></a>fitBase <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-168"><a href="factor-analysis.html#cb22-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-169"><a href="factor-analysis.html#cb22-169" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ EP + HP + DP + SP&#39;</span></span>
<span id="cb22-170"><a href="factor-analysis.html#cb22-170" aria-hidden="true" tabindex="-1"></a>fitBase <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>),</span>
<span id="cb22-171"><a href="factor-analysis.html#cb22-171" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;GP=~ SP&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-172"><a href="factor-analysis.html#cb22-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-173"><a href="factor-analysis.html#cb22-173" aria-hidden="true" tabindex="-1"></a>fitBase1 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>), </span>
<span id="cb22-174"><a href="factor-analysis.html#cb22-174" aria-hidden="true" tabindex="-1"></a>                        <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;GP=~SP&quot;</span>, <span class="st">&quot;DP~1&quot;</span>, <span class="st">&quot;HP~1&quot;</span>, <span class="st">&quot;SP~1&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-175"><a href="factor-analysis.html#cb22-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-176"><a href="factor-analysis.html#cb22-176" aria-hidden="true" tabindex="-1"></a>GP_model2 <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ c(v1,v1)*EP + c(v2,v2)*HP + c(v3,v3)*DP + c(NA, 0)*SP&#39;</span></span>
<span id="cb22-177"><a href="factor-analysis.html#cb22-177" aria-hidden="true" tabindex="-1"></a>fitIO <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model2, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;intercepts&quot;</span>), </span>
<span id="cb22-178"><a href="factor-analysis.html#cb22-178" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;DP~1&quot;</span>, <span class="st">&quot;HP~1&quot;</span>, <span class="st">&quot;SP~1&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-179"><a href="factor-analysis.html#cb22-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-180"><a href="factor-analysis.html#cb22-180" aria-hidden="true" tabindex="-1"></a>fitMarg <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">cfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">group =</span> <span class="st">&quot;gender&quot;</span>, <span class="at">group.equal =</span> <span class="fu">c</span>(<span class="st">&quot;loadings&quot;</span>, <span class="st">&quot;intercepts&quot;</span>),</span>
<span id="cb22-181"><a href="factor-analysis.html#cb22-181" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group.partial =</span> <span class="fu">c</span>(<span class="st">&quot;DP~1&quot;</span>, <span class="st">&quot;HP~1&quot;</span>, <span class="st">&quot;SP~1&quot;</span>), <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-182"><a href="factor-analysis.html#cb22-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-183"><a href="factor-analysis.html#cb22-183" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fitMarg, fitBase1)</span>
<span id="cb22-184"><a href="factor-analysis.html#cb22-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-185"><a href="factor-analysis.html#cb22-185" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb22-186"><a href="factor-analysis.html#cb22-186" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lavaan&quot;</span>)</span>
<span id="cb22-187"><a href="factor-analysis.html#cb22-187" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;SDOwave&quot;</span>)</span>
<span id="cb22-188"><a href="factor-analysis.html#cb22-188" aria-hidden="true" tabindex="-1"></a>model_sdo1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb22-189"><a href="factor-analysis.html#cb22-189" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 =~ 1*I1.1996 + a2*I2.1996 + a3*I3.1996 + a4*I4.1996</span></span>
<span id="cb22-190"><a href="factor-analysis.html#cb22-190" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 =~ 1*I1.1998 + a2*I2.1998 + a3*I3.1998 + a4*I4.1998</span></span>
<span id="cb22-191"><a href="factor-analysis.html#cb22-191" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 ~~ SDO1998</span></span>
<span id="cb22-192"><a href="factor-analysis.html#cb22-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-193"><a href="factor-analysis.html#cb22-193" aria-hidden="true" tabindex="-1"></a><span class="st">  ## intercepts</span></span>
<span id="cb22-194"><a href="factor-analysis.html#cb22-194" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1996 ~ int1*1; I1.1998 ~ int1*1</span></span>
<span id="cb22-195"><a href="factor-analysis.html#cb22-195" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1996 ~ int2*1; I2.1998 ~ int2*1 </span></span>
<span id="cb22-196"><a href="factor-analysis.html#cb22-196" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1996 ~ int3*1; I3.1998 ~ int3*1</span></span>
<span id="cb22-197"><a href="factor-analysis.html#cb22-197" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1996 ~ int4*1; I4.1998 ~ int4*1</span></span>
<span id="cb22-198"><a href="factor-analysis.html#cb22-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-199"><a href="factor-analysis.html#cb22-199" aria-hidden="true" tabindex="-1"></a><span class="st">  ## residual covariances</span></span>
<span id="cb22-200"><a href="factor-analysis.html#cb22-200" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1996 ~~ I1.1998</span></span>
<span id="cb22-201"><a href="factor-analysis.html#cb22-201" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1996 ~~ I2.1998</span></span>
<span id="cb22-202"><a href="factor-analysis.html#cb22-202" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1996 ~~ I3.1998</span></span>
<span id="cb22-203"><a href="factor-analysis.html#cb22-203" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1996 ~~ I4.1998</span></span>
<span id="cb22-204"><a href="factor-analysis.html#cb22-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-205"><a href="factor-analysis.html#cb22-205" aria-hidden="true" tabindex="-1"></a><span class="st">  ## latent means: 1996 as baseline</span></span>
<span id="cb22-206"><a href="factor-analysis.html#cb22-206" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 ~ 0*1</span></span>
<span id="cb22-207"><a href="factor-analysis.html#cb22-207" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 ~ 1&#39;</span></span>
<span id="cb22-208"><a href="factor-analysis.html#cb22-208" aria-hidden="true" tabindex="-1"></a>fitsdo1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_sdo1, <span class="at">data =</span> SDOwave, <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-209"><a href="factor-analysis.html#cb22-209" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitsdo1)[<span class="dv">22</span><span class="sc">:</span><span class="dv">23</span>,]</span>
<span id="cb22-210"><a href="factor-analysis.html#cb22-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-211"><a href="factor-analysis.html#cb22-211" aria-hidden="true" tabindex="-1"></a>model_sdo2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb22-212"><a href="factor-analysis.html#cb22-212" aria-hidden="true" tabindex="-1"></a><span class="st">  ## 1st CFA level, constant loadings across time</span></span>
<span id="cb22-213"><a href="factor-analysis.html#cb22-213" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOD1996 =~ 1*I1.1996 + d1*I2.1996</span></span>
<span id="cb22-214"><a href="factor-analysis.html#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOD1998 =~ 1*I1.1998 + d1*I2.1998</span></span>
<span id="cb22-215"><a href="factor-analysis.html#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOD1999 =~ 1*I1.1999 + d1*I2.1999 </span></span>
<span id="cb22-216"><a href="factor-analysis.html#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOE1996 =~ 1*I3.1996 + a1*I4.1996 </span></span>
<span id="cb22-217"><a href="factor-analysis.html#cb22-217" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOE1998 =~ 1*I3.1998 + a1*I4.1998</span></span>
<span id="cb22-218"><a href="factor-analysis.html#cb22-218" aria-hidden="true" tabindex="-1"></a><span class="st">  SDOE1999 =~ 1*I3.1999 + a1*I4.1999</span></span>
<span id="cb22-219"><a href="factor-analysis.html#cb22-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-220"><a href="factor-analysis.html#cb22-220" aria-hidden="true" tabindex="-1"></a><span class="st">  ## 2nd CFA level, constant loadings across time</span></span>
<span id="cb22-221"><a href="factor-analysis.html#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 =~ 1*SDOD1996 + sd1*SDOE1996</span></span>
<span id="cb22-222"><a href="factor-analysis.html#cb22-222" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 =~ 1*SDOD1998 + sd1*SDOE1998</span></span>
<span id="cb22-223"><a href="factor-analysis.html#cb22-223" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1999 =~ 1*SDOD1999 + sd1*SDOE1999</span></span>
<span id="cb22-224"><a href="factor-analysis.html#cb22-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-225"><a href="factor-analysis.html#cb22-225" aria-hidden="true" tabindex="-1"></a><span class="st">  ## Constant 1st level intercepts</span></span>
<span id="cb22-226"><a href="factor-analysis.html#cb22-226" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1996 ~ iI1*1; I1.1998 ~ iI1*1; I1.1999 ~ iI1*1</span></span>
<span id="cb22-227"><a href="factor-analysis.html#cb22-227" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1996 ~ iI2*1; I2.1998 ~ iI2*1; I2.1999 ~ iI2*1</span></span>
<span id="cb22-228"><a href="factor-analysis.html#cb22-228" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1996 ~ iI3*1; I3.1998 ~ iI3*1; I3.1999 ~ iI3*1</span></span>
<span id="cb22-229"><a href="factor-analysis.html#cb22-229" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1996 ~ iI4*1; I4.1998 ~ iI4*1; I4.1999 ~ iI4*1</span></span>
<span id="cb22-230"><a href="factor-analysis.html#cb22-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-231"><a href="factor-analysis.html#cb22-231" aria-hidden="true" tabindex="-1"></a><span class="st">  ## residual covariances:</span></span>
<span id="cb22-232"><a href="factor-analysis.html#cb22-232" aria-hidden="true" tabindex="-1"></a><span class="st">  I1.1999 ~~ I1.1998; I1.1996 ~~ I1.1998; I1.1999 ~~ I1.1996</span></span>
<span id="cb22-233"><a href="factor-analysis.html#cb22-233" aria-hidden="true" tabindex="-1"></a><span class="st">  I2.1999 ~~ I2.1998; I2.1996 ~~ I2.1998; I2.1999 ~~ I2.1996</span></span>
<span id="cb22-234"><a href="factor-analysis.html#cb22-234" aria-hidden="true" tabindex="-1"></a><span class="st">  I3.1999 ~~ I3.1998; I3.1996 ~~ I3.1998; I3.1999 ~~ I3.1996</span></span>
<span id="cb22-235"><a href="factor-analysis.html#cb22-235" aria-hidden="true" tabindex="-1"></a><span class="st">  I4.1999 ~~ I4.1998; I4.1996 ~~ I4.1998; I4.1999 ~~ I4.1996</span></span>
<span id="cb22-236"><a href="factor-analysis.html#cb22-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-237"><a href="factor-analysis.html#cb22-237" aria-hidden="true" tabindex="-1"></a><span class="st">  ## latent means</span></span>
<span id="cb22-238"><a href="factor-analysis.html#cb22-238" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1996 ~ 0*1    ## 1996 baseline year</span></span>
<span id="cb22-239"><a href="factor-analysis.html#cb22-239" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1998 ~ 1      ## 1998 vs. 1996</span></span>
<span id="cb22-240"><a href="factor-analysis.html#cb22-240" aria-hidden="true" tabindex="-1"></a><span class="st">  SDO1999 ~ 1      ## 1999 vs. 1996</span></span>
<span id="cb22-241"><a href="factor-analysis.html#cb22-241" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb22-242"><a href="factor-analysis.html#cb22-242" aria-hidden="true" tabindex="-1"></a>fitsdo2 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model_sdo2, <span class="at">data =</span> SDOwave, <span class="at">estimator =</span> <span class="st">&quot;MLR&quot;</span>)</span>
<span id="cb22-243"><a href="factor-analysis.html#cb22-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-244"><a href="factor-analysis.html#cb22-244" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fitsdo2, <span class="at">what =</span> <span class="st">&quot;est&quot;</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.7</span>, <span class="at">edge.color =</span> <span class="dv">1</span>, <span class="at">esize =</span> <span class="dv">1</span>, <span class="at">sizeMan =</span> <span class="dv">6</span>, <span class="at">asize =</span> <span class="fl">2.5</span>,</span>
<span id="cb22-245"><a href="factor-analysis.html#cb22-245" aria-hidden="true" tabindex="-1"></a>         <span class="at">intercepts =</span> <span class="cn">FALSE</span>, <span class="at">rotation =</span> <span class="dv">4</span>, <span class="at">thresholdColor =</span> <span class="st">&quot;red&quot;</span>, <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fl">1.5</span>, <span class="dv">5</span>), <span class="at">fade =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-246"><a href="factor-analysis.html#cb22-246" aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fitsdo2)[<span class="dv">43</span><span class="sc">:</span><span class="dv">45</span>,]</span>
<span id="cb22-247"><a href="factor-analysis.html#cb22-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-248"><a href="factor-analysis.html#cb22-248" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;FamilyIQ&quot;</span>)</span>
<span id="cb22-249"><a href="factor-analysis.html#cb22-249" aria-hidden="true" tabindex="-1"></a>modelIQ <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb22-250"><a href="factor-analysis.html#cb22-250" aria-hidden="true" tabindex="-1"></a><span class="st"> level: 1</span></span>
<span id="cb22-251"><a href="factor-analysis.html#cb22-251" aria-hidden="true" tabindex="-1"></a><span class="st">  numeric =~ wordlist + cards + matrices</span></span>
<span id="cb22-252"><a href="factor-analysis.html#cb22-252" aria-hidden="true" tabindex="-1"></a><span class="st">  perception =~ figures + animals + occupation</span></span>
<span id="cb22-253"><a href="factor-analysis.html#cb22-253" aria-hidden="true" tabindex="-1"></a><span class="st"> level: 2</span></span>
<span id="cb22-254"><a href="factor-analysis.html#cb22-254" aria-hidden="true" tabindex="-1"></a><span class="st">  general =~ wordlist + cards +  matrices + figures + animals +</span></span>
<span id="cb22-255"><a href="factor-analysis.html#cb22-255" aria-hidden="true" tabindex="-1"></a><span class="st">             occupation&#39;</span></span>
<span id="cb22-256"><a href="factor-analysis.html#cb22-256" aria-hidden="true" tabindex="-1"></a>fitIQ <span class="ot">&lt;-</span> <span class="fu">cfa</span>(modelIQ, <span class="at">data =</span> FamilyIQ, <span class="at">cluster =</span> <span class="st">&quot;family&quot;</span>, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-257"><a href="factor-analysis.html#cb22-257" aria-hidden="true" tabindex="-1"></a>fitIQ</span>
<span id="cb22-258"><a href="factor-analysis.html#cb22-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-259"><a href="factor-analysis.html#cb22-259" aria-hidden="true" tabindex="-1"></a><span class="do">## ----- bayesian confirmatory factor analysis</span></span>
<span id="cb22-260"><a href="factor-analysis.html#cb22-260" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;blavaan&quot;</span>)</span>
<span id="cb22-261"><a href="factor-analysis.html#cb22-261" aria-hidden="true" tabindex="-1"></a><span class="fu">dpriors</span>()[<span class="fu">c</span>(<span class="st">&quot;lambda&quot;</span>, <span class="st">&quot;itheta&quot;</span>, <span class="st">&quot;ipsi&quot;</span>)]</span>
<span id="cb22-262"><a href="factor-analysis.html#cb22-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-263"><a href="factor-analysis.html#cb22-263" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;MPsychoR&quot;</span>)</span>
<span id="cb22-264"><a href="factor-analysis.html#cb22-264" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Bergh&quot;</span>)</span>
<span id="cb22-265"><a href="factor-analysis.html#cb22-265" aria-hidden="true" tabindex="-1"></a>GP_model <span class="ot">&lt;-</span> <span class="st">&#39;GP =~ EP + HP + DP + SP&#39;</span></span>
<span id="cb22-266"><a href="factor-analysis.html#cb22-266" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-267"><a href="factor-analysis.html#cb22-267" aria-hidden="true" tabindex="-1"></a>fitBCFA <span class="ot">&lt;-</span> <span class="fu">bcfa</span>(GP_model, <span class="at">data =</span> Bergh, <span class="at">burnin =</span> <span class="dv">2000</span>, <span class="at">sample =</span> <span class="dv">10000</span>, <span class="at">n.chains =</span> <span class="dv">2</span>)</span>
<span id="cb22-268"><a href="factor-analysis.html#cb22-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-269"><a href="factor-analysis.html#cb22-269" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitBCFA, <span class="at">pars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">plot.type =</span> <span class="st">&quot;trace&quot;</span>)</span>
<span id="cb22-270"><a href="factor-analysis.html#cb22-270" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fitBCFA, <span class="at">pars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">plot.type =</span> <span class="st">&quot;autocorr&quot;</span>)</span>
<span id="cb22-271"><a href="factor-analysis.html#cb22-271" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitBCFA)</span></code></pre></div>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Desjardins, Christopher D., and Okan Bulut. 2018. <em>Handbook of Educational Measurement and Psychometrics Using <span>R</span></em>. CRC Press.
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="generalizability-theory.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
